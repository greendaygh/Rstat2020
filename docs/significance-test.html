<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Significance test | R로 배우는 기초통계</title>
  <meta name="description" content="UST lecture web site" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Significance test | R로 배우는 기초통계" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="UST lecture web site" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Significance test | R로 배우는 기초통계" />
  
  <meta name="twitter:description" content="UST lecture web site" />
  

<meta name="author" content="한국생명공학연구원 김하성" />


<meta name="date" content="2020-11-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-inference.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> Introduction to statistics with R </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction 강의 개요</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#goal-강의-목표"><i class="fa fa-check"></i><b>1.1</b> Goal 강의 목표</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#this-course"><i class="fa fa-check"></i><b>1.2</b> This course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#tips"><i class="fa fa-check"></i><b>1.3</b> Tips</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#references-books-참고-교제"><i class="fa fa-check"></i><b>1.4</b> References books 참고 교제</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references-참고-자료"><i class="fa fa-check"></i><b>1.5</b> References 참고 자료</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#evaluation-평가-세부-항목"><i class="fa fa-check"></i><b>1.6</b> Evaluation 평가 세부 항목</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#schedule-강의-계획"><i class="fa fa-check"></i><b>1.7</b> Schedule 강의 계획</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#r-lecture-youtube-link"><i class="fa fa-check"></i><b>1.8</b> R Lecture Youtube Link</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#lecture-chapter-1"><i class="fa fa-check"></i><b>1.8.1</b> Lecture Chapter 1</a></li>
<li class="chapter" data-level="1.8.2" data-path="index.html"><a href="index.html#lecture-2"><i class="fa fa-check"></i><b>1.8.2</b> Lecture 2</a></li>
<li class="chapter" data-level="1.8.3" data-path="index.html"><a href="index.html#lecture-3"><i class="fa fa-check"></i><b>1.8.3</b> Lecture 3</a></li>
<li class="chapter" data-level="1.8.4" data-path="index.html"><a href="index.html#lecture-4"><i class="fa fa-check"></i><b>1.8.4</b> Lecture 4</a></li>
<li class="chapter" data-level="1.8.5" data-path="index.html"><a href="index.html#lecture-5"><i class="fa fa-check"></i><b>1.8.5</b> Lecture 5</a></li>
<li class="chapter" data-level="1.8.6" data-path="index.html"><a href="index.html#lecture-6"><i class="fa fa-check"></i><b>1.8.6</b> Lecture 6</a></li>
<li class="chapter" data-level="1.8.7" data-path="index.html"><a href="index.html#lecture-7"><i class="fa fa-check"></i><b>1.8.7</b> Lecture 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> R basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-basics.html"><a href="r-basics.html#what-is-r-rstudio"><i class="fa fa-check"></i><b>2.1</b> What is R / Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="r-basics.html"><a href="r-basics.html#r-rstudio-installation"><i class="fa fa-check"></i><b>2.2</b> R / Rstudio installation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="r-basics.html"><a href="r-basics.html#r-설치"><i class="fa fa-check"></i><b>2.2.1</b> R 설치</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-basics.html"><a href="r-basics.html#rstudio-설치"><i class="fa fa-check"></i><b>2.2.2</b> Rstudio 설치</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html#rstudio-interface"><i class="fa fa-check"></i><b>2.3</b> Rstudio interface</a></li>
<li class="chapter" data-level="2.4" data-path="r-basics.html"><a href="r-basics.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4</b> Keyboard shortcuts</a></li>
<li class="chapter" data-level="2.5" data-path="r-basics.html"><a href="r-basics.html#r-programming-basics-and-terminology"><i class="fa fa-check"></i><b>2.5</b> R programming basics and terminology</a></li>
<li class="chapter" data-level="2.6" data-path="r-basics.html"><a href="r-basics.html#set-a-working-directory"><i class="fa fa-check"></i><b>2.6</b> Set a working directory</a></li>
<li class="chapter" data-level="2.7" data-path="r-basics.html"><a href="r-basics.html#r-coding-practice"><i class="fa fa-check"></i><b>2.7</b> R coding practice</a></li>
<li class="chapter" data-level="2.8" data-path="r-basics.html"><a href="r-basics.html#variables-and-values"><i class="fa fa-check"></i><b>2.8</b> Variables and values</a></li>
<li class="chapter" data-level="2.9" data-path="r-basics.html"><a href="r-basics.html#variable-type-of-storage-mode"><i class="fa fa-check"></i><b>2.9</b> Variable type of (storage) mode</a></li>
<li class="chapter" data-level="2.10" data-path="r-basics.html"><a href="r-basics.html#variable---vectors"><i class="fa fa-check"></i><b>2.10</b> Variable - Vectors</a></li>
<li class="chapter" data-level="2.11" data-path="r-basics.html"><a href="r-basics.html#functions"><i class="fa fa-check"></i><b>2.11</b> Functions</a></li>
<li class="chapter" data-level="2.12" data-path="r-basics.html"><a href="r-basics.html#vectorized-functions"><i class="fa fa-check"></i><b>2.12</b> Vectorized functions</a></li>
<li class="chapter" data-level="2.13" data-path="r-basics.html"><a href="r-basics.html#help"><i class="fa fa-check"></i><b>2.13</b> Help</a></li>
<li class="chapter" data-level="2.14" data-path="r-basics.html"><a href="r-basics.html#r-packages"><i class="fa fa-check"></i><b>2.14</b> R packages</a></li>
<li class="chapter" data-level="2.15" data-path="r-basics.html"><a href="r-basics.html#data-sets"><i class="fa fa-check"></i><b>2.15</b> Data sets</a></li>
<li class="chapter" data-level="2.16" data-path="r-basics.html"><a href="r-basics.html#cheatsheet"><i class="fa fa-check"></i><b>2.16</b> Cheatsheet</a></li>
<li class="chapter" data-level="2.17" data-path="r-basics.html"><a href="r-basics.html#problems"><i class="fa fa-check"></i><b>2.17</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="univariat-data.html"><a href="univariat-data.html"><i class="fa fa-check"></i><b>3</b> Univariat data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="univariat-data.html"><a href="univariat-data.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction 2</a></li>
<li class="chapter" data-level="3.2" data-path="univariat-data.html"><a href="univariat-data.html#data-vectors"><i class="fa fa-check"></i><b>3.2</b> Data vectors</a></li>
<li class="chapter" data-level="3.3" data-path="univariat-data.html"><a href="univariat-data.html#data-type"><i class="fa fa-check"></i><b>3.3</b> Data type</a></li>
<li class="chapter" data-level="3.4" data-path="univariat-data.html"><a href="univariat-data.html#functions-2"><i class="fa fa-check"></i><b>3.4</b> Functions 2</a></li>
<li class="chapter" data-level="3.5" data-path="univariat-data.html"><a href="univariat-data.html#miscellaneous-1"><i class="fa fa-check"></i><b>3.5</b> Miscellaneous 1</a></li>
<li class="chapter" data-level="3.6" data-path="univariat-data.html"><a href="univariat-data.html#numeric-summaries"><i class="fa fa-check"></i><b>3.6</b> Numeric summaries</a></li>
<li class="chapter" data-level="3.7" data-path="univariat-data.html"><a href="univariat-data.html#center-for-a-univariat-variable"><i class="fa fa-check"></i><b>3.7</b> Center for a univariat variable</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="univariat-data.html"><a href="univariat-data.html#sample-mean"><i class="fa fa-check"></i><b>3.7.1</b> Sample mean</a></li>
<li class="chapter" data-level="3.7.2" data-path="univariat-data.html"><a href="univariat-data.html#measure-of-position"><i class="fa fa-check"></i><b>3.7.2</b> Measure of Position</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="univariat-data.html"><a href="univariat-data.html#spread-for-a-univariat-variable"><i class="fa fa-check"></i><b>3.8</b> Spread for a univariat variable</a></li>
<li class="chapter" data-level="3.9" data-path="univariat-data.html"><a href="univariat-data.html#problems-02"><i class="fa fa-check"></i><b>3.9</b> Problems 02</a></li>
<li class="chapter" data-level="3.10" data-path="univariat-data.html"><a href="univariat-data.html#shape-for-a-univariat-variable"><i class="fa fa-check"></i><b>3.10</b> Shape for a univariat variable</a></li>
<li class="chapter" data-level="3.11" data-path="univariat-data.html"><a href="univariat-data.html#viewing-the-shape"><i class="fa fa-check"></i><b>3.11</b> Viewing the shape</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="univariat-data.html"><a href="univariat-data.html#histogram"><i class="fa fa-check"></i><b>3.11.1</b> Histogram</a></li>
<li class="chapter" data-level="3.11.2" data-path="univariat-data.html"><a href="univariat-data.html#density-plots"><i class="fa fa-check"></i><b>3.11.2</b> Density plots</a></li>
<li class="chapter" data-level="3.11.3" data-path="univariat-data.html"><a href="univariat-data.html#boxplots"><i class="fa fa-check"></i><b>3.11.3</b> Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="univariat-data.html"><a href="univariat-data.html#quantile-graph"><i class="fa fa-check"></i><b>3.12</b> Quantile graph</a></li>
<li class="chapter" data-level="3.13" data-path="univariat-data.html"><a href="univariat-data.html#categorical-data"><i class="fa fa-check"></i><b>3.13</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bivariate-data.html"><a href="bivariate-data.html"><i class="fa fa-check"></i><b>4</b> Bivariate data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="bivariate-data.html"><a href="bivariate-data.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction 3</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="bivariate-data.html"><a href="bivariate-data.html#independence-samples"><i class="fa fa-check"></i><b>4.1.1</b> Independence samples</a></li>
<li class="chapter" data-level="4.1.2" data-path="bivariate-data.html"><a href="bivariate-data.html#plot"><i class="fa fa-check"></i><b>4.1.2</b> plot</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bivariate-data.html"><a href="bivariate-data.html#data-manipulation"><i class="fa fa-check"></i><b>4.2</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="bivariate-data.html"><a href="bivariate-data.html#list"><i class="fa fa-check"></i><b>4.2.1</b> List</a></li>
<li class="chapter" data-level="4.2.2" data-path="bivariate-data.html"><a href="bivariate-data.html#data-frame"><i class="fa fa-check"></i><b>4.2.2</b> Data frame</a></li>
<li class="chapter" data-level="4.2.3" data-path="bivariate-data.html"><a href="bivariate-data.html#model-formulas"><i class="fa fa-check"></i><b>4.2.3</b> Model formulas</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="bivariate-data.html"><a href="bivariate-data.html#paired-data"><i class="fa fa-check"></i><b>4.3</b> Paired data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="bivariate-data.html"><a href="bivariate-data.html#pearson-correlation"><i class="fa fa-check"></i><b>4.3.1</b> Pearson Correlation</a></li>
<li class="chapter" data-level="4.3.2" data-path="bivariate-data.html"><a href="bivariate-data.html#spearman-correlation-coefficient"><i class="fa fa-check"></i><b>4.3.2</b> Spearman correlation coefficient</a></li>
<li class="chapter" data-level="4.3.3" data-path="bivariate-data.html"><a href="bivariate-data.html#correlation-causation-and-association"><i class="fa fa-check"></i><b>4.3.3</b> Correlation, causation and association</a></li>
<li class="chapter" data-level="4.3.4" data-path="bivariate-data.html"><a href="bivariate-data.html#trends"><i class="fa fa-check"></i><b>4.3.4</b> Trends</a></li>
<li class="chapter" data-level="4.3.5" data-path="bivariate-data.html"><a href="bivariate-data.html#the-method-of-least-squares"><i class="fa fa-check"></i><b>4.3.5</b> The method of least squares</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bivariate-data.html"><a href="bivariate-data.html#problems-03"><i class="fa fa-check"></i><b>4.4</b> Problems 03</a></li>
<li class="chapter" data-level="4.5" data-path="bivariate-data.html"><a href="bivariate-data.html#bivariate-categorical-data"><i class="fa fa-check"></i><b>4.5</b> Bivariate categorical data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="bivariate-data.html"><a href="bivariate-data.html#contingency-tables"><i class="fa fa-check"></i><b>4.5.1</b> Contingency tables</a></li>
<li class="chapter" data-level="4.5.2" data-path="bivariate-data.html"><a href="bivariate-data.html#marginal-distributions"><i class="fa fa-check"></i><b>4.5.2</b> Marginal distributions</a></li>
<li class="chapter" data-level="4.5.3" data-path="bivariate-data.html"><a href="bivariate-data.html#conditional-distributions"><i class="fa fa-check"></i><b>4.5.3</b> Conditional distributions</a></li>
<li class="chapter" data-level="4.5.4" data-path="bivariate-data.html"><a href="bivariate-data.html#graphical-summaries-of-contingency-tables"><i class="fa fa-check"></i><b>4.5.4</b> Graphical summaries of contingency tables</a></li>
<li class="chapter" data-level="4.5.5" data-path="bivariate-data.html"><a href="bivariate-data.html#measures-of-association-for-categorical-data"><i class="fa fa-check"></i><b>4.5.5</b> Measures of association for categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="bivariate-data.html"><a href="bivariate-data.html#problems-04"><i class="fa fa-check"></i><b>4.6</b> Problems 04</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html"><i class="fa fa-check"></i><b>5</b> Data transformation basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#data-structures-in-r"><i class="fa fa-check"></i><b>5.1</b> Data structures in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#vectors"><i class="fa fa-check"></i><b>5.1.1</b> Vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#lists"><i class="fa fa-check"></i><b>5.1.2</b> Lists</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#matrices"><i class="fa fa-check"></i><b>5.1.3</b> Matrices</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#data.frame"><i class="fa fa-check"></i><b>5.1.4</b> data.frame</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#subset"><i class="fa fa-check"></i><b>5.2</b> subset</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#merging-and-split"><i class="fa fa-check"></i><b>5.3</b> merging and split</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#transforming-data"><i class="fa fa-check"></i><b>5.4</b> transforming data</a></li>
<li class="chapter" data-level="5.5" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#analysis-example-babies"><i class="fa fa-check"></i><b>5.5</b> Analysis example (babies)</a></li>
<li class="chapter" data-level="5.6" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#apply"><i class="fa fa-check"></i><b>5.6</b> apply</a></li>
<li class="chapter" data-level="5.7" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#problems-05"><i class="fa fa-check"></i><b>5.7</b> Problems 05</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html"><i class="fa fa-check"></i><b>6</b> Multivariate (tydiverse)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#tidy-data-structure"><i class="fa fa-check"></i><b>6.1</b> Tidy data structure</a></li>
<li class="chapter" data-level="6.2" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#data-manipulation-with-dplyr"><i class="fa fa-check"></i><b>6.2</b> Data manipulation with dplyr</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#dplyr---pipe-operator"><i class="fa fa-check"></i><b>6.2.1</b> dplyr - pipe operator</a></li>
<li class="chapter" data-level="6.2.2" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#dplyr---important-functions"><i class="fa fa-check"></i><b>6.2.2</b> dplyr - Important functions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#code-comparison"><i class="fa fa-check"></i><b>6.3</b> code comparison</a></li>
<li class="chapter" data-level="6.4" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#dplyr-example-iris"><i class="fa fa-check"></i><b>6.4</b> dplyr example iris</a></li>
<li class="chapter" data-level="6.5" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#problems-06"><i class="fa fa-check"></i><b>6.5</b> Problems 06</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="populations.html"><a href="populations.html"><i class="fa fa-check"></i><b>7</b> Populations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="populations.html"><a href="populations.html#random-variable"><i class="fa fa-check"></i><b>7.1</b> Random variable</a></li>
<li class="chapter" data-level="7.2" data-path="populations.html"><a href="populations.html#discrete-random-variable"><i class="fa fa-check"></i><b>7.2</b> Discrete random variable</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="populations.html"><a href="populations.html#probability-mass-function"><i class="fa fa-check"></i><b>7.2.1</b> Probability mass function</a></li>
<li class="chapter" data-level="7.2.2" data-path="populations.html"><a href="populations.html#mean-and-standard-deviation-of-discrete-r.v."><i class="fa fa-check"></i><b>7.2.2</b> Mean and standard deviation of discrete R.V.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="populations.html"><a href="populations.html#continuous-random-variable"><i class="fa fa-check"></i><b>7.3</b> Continuous random variable</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="populations.html"><a href="populations.html#probability-density-function"><i class="fa fa-check"></i><b>7.3.1</b> Probability density function</a></li>
<li class="chapter" data-level="7.3.2" data-path="populations.html"><a href="populations.html#mean-and-standard-deviation-of-continuous-r.v."><i class="fa fa-check"></i><b>7.3.2</b> Mean and standard deviation of continuous R.V.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="populations.html"><a href="populations.html#sampling-from-a-population"><i class="fa fa-check"></i><b>7.4</b> Sampling from a population</a></li>
<li class="chapter" data-level="7.5" data-path="populations.html"><a href="populations.html#problems-07"><i class="fa fa-check"></i><b>7.5</b> Problems 07</a></li>
<li class="chapter" data-level="7.6" data-path="populations.html"><a href="populations.html#sampling-distribution"><i class="fa fa-check"></i><b>7.6</b> Sampling distribution</a></li>
<li class="chapter" data-level="7.7" data-path="populations.html"><a href="populations.html#probability-distributions"><i class="fa fa-check"></i><b>7.7</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="populations.html"><a href="populations.html#bernoulli-random-variables"><i class="fa fa-check"></i><b>7.7.1</b> Bernoulli random variables</a></li>
<li class="chapter" data-level="7.7.2" data-path="populations.html"><a href="populations.html#binomial-random-variables"><i class="fa fa-check"></i><b>7.7.2</b> Binomial random variables</a></li>
<li class="chapter" data-level="7.7.3" data-path="populations.html"><a href="populations.html#normal-random-variables"><i class="fa fa-check"></i><b>7.7.3</b> Normal random variables</a></li>
<li class="chapter" data-level="7.7.4" data-path="populations.html"><a href="populations.html#uniform-distribution"><i class="fa fa-check"></i><b>7.7.4</b> Uniform distribution</a></li>
<li class="chapter" data-level="7.7.5" data-path="populations.html"><a href="populations.html#poisson-distribution"><i class="fa fa-check"></i><b>7.7.5</b> Poisson distribution</a></li>
<li class="chapter" data-level="7.7.6" data-path="populations.html"><a href="populations.html#exponential-distribution"><i class="fa fa-check"></i><b>7.7.6</b> Exponential distribution</a></li>
<li class="chapter" data-level="7.7.7" data-path="populations.html"><a href="populations.html#sampling-distributions"><i class="fa fa-check"></i><b>7.7.7</b> Sampling distributions</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="populations.html"><a href="populations.html#problems-07-2"><i class="fa fa-check"></i><b>7.8</b> Problems 07-2</a></li>
<li class="chapter" data-level="7.9" data-path="populations.html"><a href="populations.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>7.9</b> The central limit theorem</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>8</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="statistical-inference.html"><a href="statistical-inference.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="statistical-inference.html"><a href="statistical-inference.html#simulation"><i class="fa fa-check"></i><b>8.2</b> Simulation</a></li>
<li class="chapter" data-level="8.3" data-path="statistical-inference.html"><a href="statistical-inference.html#z-statistics-with-simulation"><i class="fa fa-check"></i><b>8.3</b> z-statistics with simulation</a></li>
<li class="chapter" data-level="8.4" data-path="statistical-inference.html"><a href="statistical-inference.html#t-statistics"><i class="fa fa-check"></i><b>8.4</b> t-statistics</a></li>
<li class="chapter" data-level="8.5" data-path="statistical-inference.html"><a href="statistical-inference.html#two-sample-significance-tests"><i class="fa fa-check"></i><b>8.5</b> Two sample significance tests</a></li>
<li class="chapter" data-level="8.6" data-path="statistical-inference.html"><a href="statistical-inference.html#estimation-and-confidence-interval"><i class="fa fa-check"></i><b>8.6</b> Estimation and confidence interval</a></li>
<li class="chapter" data-level="8.7" data-path="statistical-inference.html"><a href="statistical-inference.html#bootstrap"><i class="fa fa-check"></i><b>8.7</b> Bootstrap</a></li>
<li class="chapter" data-level="8.8" data-path="statistical-inference.html"><a href="statistical-inference.html#problem-08"><i class="fa fa-check"></i><b>8.8</b> Problem 08</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="significance-test.html"><a href="significance-test.html"><i class="fa fa-check"></i><b>9</b> Significance test</a>
<ul>
<li class="chapter" data-level="9.1" data-path="significance-test.html"><a href="significance-test.html#significance-test-for-a-population-proportion"><i class="fa fa-check"></i><b>9.1</b> Significance test for a population proportion</a></li>
<li class="chapter" data-level="9.2" data-path="significance-test.html"><a href="significance-test.html#significance-test-for-the-mean-t-test"><i class="fa fa-check"></i><b>9.2</b> Significance test for the mean (t-test)</a></li>
<li class="chapter" data-level="9.3" data-path="significance-test.html"><a href="significance-test.html#two-sample-test-of-proportion"><i class="fa fa-check"></i><b>9.3</b> Two sample test of proportion</a></li>
<li class="chapter" data-level="9.4" data-path="significance-test.html"><a href="significance-test.html#two-sample-test-of-center"><i class="fa fa-check"></i><b>9.4</b> Two sample test of center</a></li>
<li class="chapter" data-level="9.5" data-path="significance-test.html"><a href="significance-test.html#association-for-categorical-data"><i class="fa fa-check"></i><b>9.5</b> Association for categorical data</a></li>
<li class="chapter" data-level="9.6" data-path="significance-test.html"><a href="significance-test.html#variable-type-and-testing-methods"><i class="fa fa-check"></i><b>9.6</b> Variable type and testing methods</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R로 배우는 기초통계</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="significance-test" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Significance test</h1>
<p>신뢰구간은 (구간추정) 통계적 추론의 방법 중 하나이며 유의성검정은 가설을 검정하는 또 다른 추론의 방법입니다. 유의성 검정은 모수에 대한 특정 값을 추정한 후 (점추정) 기반 가설의 분포로부터 해당 값이 나올 확률을 계산하여 검정을 수행합니다.</p>
<p>유의성검정을 재판 과정의 배심원 입장으로 생각하면 이해가 쉬울 수 있습니다. 검사는 피의자가 유죄임을 주장하며 배심원들을 설득합니다. 배심원들은 피의자가 유죄라는 확정적 증거가 없는 한 무고하다는 가정을 하고 있으며 증거가 많아질수록 자신들이 가정한 무죄가 아닐 확률은 점점 적어집니다. 즉, 확률이 충분히 작으면 무죄라는 가정을 버리고 검사의 주장을 받아들이게 됩니다.</p>
<p>다른 예를 들어봅시다. 어떤 영업사원이 A 회사에서 판매하는 기계의 영점이 평균 0으로 맞춰저 있다고 주장을 하며 해당 기계를 팔고 있습니다. 실제로 판매하는 기계의 영점이 0으로 맞춰져 있을 때 (0이 참) 우리 입장에서는 영업사원의 말은 당장 증명할 수 없는 가설일 뿐입니다. 그래도 그 가설을 믿고 (채택하고) 기계를 구입할 경우 오류 없는 정상적인 거래가 됩니다. 그런데 우리가 영점이 2라고 의심을 하며 영업사원의 말을 믿지 않고 (가설을 기각하고) 기계를 구입하지 않는다면 오류가 발생한 것입니다. 이 상황을 그래프로 알아봅니다 (편의상 기계 영점의 분산은 1이라고 가정, <code>ggplot</code> 코드도 다시 익혀 봅니다).</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="significance-test.html#cb193-1"></a>x1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb193-2"><a href="significance-test.html#cb193-2"></a>y1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x1, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb193-3"><a href="significance-test.html#cb193-3"></a>z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x1, y1)</span>
<span id="cb193-4"><a href="significance-test.html#cb193-4"></a>pval &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb193-5"><a href="significance-test.html#cb193-5"></a><span class="kw">ggplot</span>(z) <span class="op">+</span></span>
<span id="cb193-6"><a href="significance-test.html#cb193-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x1, y1), <span class="dt">color=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span></span>
<span id="cb193-7"><a href="significance-test.html#cb193-7"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb193-8"><a href="significance-test.html#cb193-8"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb193-9"><a href="significance-test.html#cb193-9"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data=</span><span class="kw">filter</span>(z, x1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>), </span>
<span id="cb193-10"><a href="significance-test.html#cb193-10"></a>            <span class="kw">aes</span>(x1, y1), </span>
<span id="cb193-11"><a href="significance-test.html#cb193-11"></a>            <span class="dt">fill=</span><span class="st">&quot;#80008055&quot;</span>) <span class="op">+</span></span>
<span id="cb193-12"><a href="significance-test.html#cb193-12"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">3</span>, <span class="dt">y=</span><span class="fl">0.1</span>, <span class="dt">label=</span>pval) <span class="op">+</span></span>
<span id="cb193-13"><a href="significance-test.html#cb193-13"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">3</span>, <span class="dt">xend=</span><span class="fl">2.3</span>, <span class="dt">y=</span><span class="fl">0.09</span>, <span class="dt">yend=</span><span class="fl">0.01</span>), </span>
<span id="cb193-14"><a href="significance-test.html#cb193-14"></a>               <span class="dt">arrow=</span><span class="kw">arrow</span>(<span class="dt">length=</span><span class="kw">unit</span>(<span class="fl">0.1</span>,<span class="st">&#39;inch&#39;</span>)),</span>
<span id="cb193-15"><a href="significance-test.html#cb193-15"></a>               <span class="dt">color=</span><span class="st">&#39;black&#39;</span>,</span>
<span id="cb193-16"><a href="significance-test.html#cb193-16"></a>               <span class="dt">size=</span><span class="dv">1</span>)</span></code></pre></div>
<p>위 그래프에서 실제 기계들의 평균 영점이 0임인 분포만을 생각하면 면적의 넓이 0.0228은 2보다 큰 영점을 가지는 기계가 생산될 확률입니다. 이 실제 사실에 더하여 “영점이 0이다”라는 가설의 분포를 생각하면 (가설과 사실의 분포가 겹쳐있음) 면적의 넓이 0.0228 부분은 2를 기준으로 가설을 받아들이지 않는 (기각하는) 경우로 볼 수 있으며 결국 실제 사실도 받아들이지 않는 오류를 범할 확률을 나타냅니다. 이 오류를 우리는 “제1종오류 (<span class="math inline">\(\alpha\)</span>)” 라고 합니다.</p>
<p>이제 영업사원의 가설이 거짓일 경우를 생각해 봅니다. 즉, 어떤 이유로 A회사 기계의 영점이 평균 3일 경우 영업사원의 “영점이 0이다”라는 주장은 거짓이 됩니다. 이 상황에서도 우리는 두 가지 경우를 생각할 수 있습니다. 영업사원의 가설을 믿고 (채택하고) 기계를 구입할 경우는 오류가 발생하는 상황과 영점이 2라는 의심으로 영업사원의 가설을 믿지않고 (기각하고) 기계를 구입하지 않는 올바른 판단을 한 상황 입니다.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="significance-test.html#cb194-1"></a>x1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb194-2"><a href="significance-test.html#cb194-2"></a>y1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x1, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb194-3"><a href="significance-test.html#cb194-3"></a>x2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">11</span>, <span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb194-4"><a href="significance-test.html#cb194-4"></a>y2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x2, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb194-5"><a href="significance-test.html#cb194-5"></a>z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x1, y1, x2, y2)</span>
<span id="cb194-6"><a href="significance-test.html#cb194-6"></a><span class="co">#pval &lt;- round(1-pnorm(2,0,1), 4)</span></span>
<span id="cb194-7"><a href="significance-test.html#cb194-7"></a><span class="kw">ggplot</span>(z) <span class="op">+</span></span>
<span id="cb194-8"><a href="significance-test.html#cb194-8"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x1, y1), <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb194-9"><a href="significance-test.html#cb194-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x2, y2), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb194-10"><a href="significance-test.html#cb194-10"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb194-11"><a href="significance-test.html#cb194-11"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb194-12"><a href="significance-test.html#cb194-12"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data=</span><span class="kw">filter</span>(z, x1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>), </span>
<span id="cb194-13"><a href="significance-test.html#cb194-13"></a>            <span class="kw">aes</span>(x1, y1), </span>
<span id="cb194-14"><a href="significance-test.html#cb194-14"></a>            <span class="dt">fill=</span><span class="st">&quot;#0000ff55&quot;</span>) <span class="op">+</span></span>
<span id="cb194-15"><a href="significance-test.html#cb194-15"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data=</span><span class="kw">filter</span>(z, x2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>), </span>
<span id="cb194-16"><a href="significance-test.html#cb194-16"></a>            <span class="kw">aes</span>(x2, y2), </span>
<span id="cb194-17"><a href="significance-test.html#cb194-17"></a>            <span class="dt">fill=</span><span class="st">&quot;#ff000055&quot;</span>) <span class="op">+</span></span>
<span id="cb194-18"><a href="significance-test.html#cb194-18"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">3</span>, <span class="dt">y=</span><span class="fl">0.1</span>, <span class="dt">label=</span>pval) <span class="op">+</span></span>
<span id="cb194-19"><a href="significance-test.html#cb194-19"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">3</span>, <span class="dt">xend=</span><span class="fl">2.3</span>, <span class="dt">y=</span><span class="fl">0.09</span>, <span class="dt">yend=</span><span class="fl">0.01</span>), </span>
<span id="cb194-20"><a href="significance-test.html#cb194-20"></a>               <span class="dt">arrow=</span><span class="kw">arrow</span>(<span class="dt">length=</span><span class="kw">unit</span>(<span class="fl">0.1</span>,<span class="st">&#39;inch&#39;</span>)),</span>
<span id="cb194-21"><a href="significance-test.html#cb194-21"></a>               <span class="dt">color=</span><span class="st">&#39;black&#39;</span>,</span>
<span id="cb194-22"><a href="significance-test.html#cb194-22"></a>               <span class="dt">size=</span><span class="dv">1</span>)</span></code></pre></div>
<p>이 때는 실제 사실의 분포와(red) 가설의 분포가(blue) 다릅니다. 실제 사실의 분포 입장에서 2를 기준으로 가설을 기각하는 상황은 올바른 판단을 하는 상황입니다. 그러나 2를 기준으로 가설을 받아들이는 경우, 실제 사실은 받아들이지 않게 되는 오류가 발생합니다. 이 오류를 “제2종오류 (<span class="math inline">\(\beta\)</span>)”라고 합니다.</p>
<p>일반적으로 실제 사실은 모집단의 모수와 같이 알 수 없는 값입니다. 따라서 우리는 가설의 분포를 가지고 판단을 하게되며 이 때 <span class="math inline">\(\alpha\)</span>와 <span class="math inline">\(\beta\)</span> 오류는 위 그림이 보여주는 것처럼 서로 trade off 관계에 있게 됩니다. 즉, 임의의 가설을 기반으로 특정 관측값의 유의성을 판단할 때 제1종오류를 최소화 하려하면 제2종오류는 최대화 되고 그 반대로 제2종오류를 최소화 하면 제1종오류는 오히려 커지게 되는 것 입니다.</p>
<p>유의성검정에서 <span class="math inline">\(H_0\)</span>는 귀무가설(Null hypothesis)이고 <span class="math inline">\(H_1\)</span>을 대립가설(alternative hypothesis)이라 합니다. 일반적으로 <span class="math inline">\(H_1\)</span>이 사람들이 관심있는 주장이고 유의성검정을 위해서 사람들의 주장의 반대인 <span class="math inline">\(H_0\)</span>를 가정합니다. 만약 <span class="math inline">\(H_0\)</span> 가정 하에서 만들어진 통계량의 관측될 확률이 작으면 가정이 틀린 것으로 <span class="math inline">\(H_0\)</span>를 기각하고 사람들이 주장하는 <span class="math inline">\(H_1\)</span>을 채택합니다. 여기서 계산된 통계량이 관측될 확률을 유의확률(p-value) 이라 하며 유의성검정은 p-value를 계산하는 것과 같습니다. 위 그림에서 0.0228 값이 p-value 입니다.</p>
<p><span class="math display">\[
\text{p-value} = P(\text{test statistic is the observed value or is more extreme}|H_0)
\]</span></p>
<p>p-value의 크고 작음을 판단하는 대략적인 범위는 다음과 같습니다.</p>
<p><img src="images/09/01.png" /></p>
<p>유의성검정에서는 <span class="math inline">\(H_0\)</span>가 참인지 거짓인지 판별하기 보다는 유의수준(significance level, <span class="math inline">\(\alpha\)</span>)이라는 기준에 따라서 H0를 기각할지 안할지를 판단하게 됩니다. 위 영점 예제에서 제1종오류 <span class="math inline">\(alpha\)</span>가 유의수준과 같은 의미 입니다. 일반적인 유의수준은 0.01, 0.05, 0.1 정도로 p-value가 이들 값보다 작게 나오면 <span class="math inline">\(H_0\)</span>를 기각합니다. 앞서 기계 영점에 대한 예제에서와 같이 <span class="math inline">\(\alpha\)</span>를 기준으로 <span class="math inline">\(H_0\)</span>를 기각 할 경우 두 가지 오류, 제1종오류 (type-I error)와 제2종오류 (type-II error)가 발생할 수 있습니다.</p>
<p><img src="images/09/02.png" /></p>
<p>귀무가설 참 –&gt; 채택 (o)<br />
귀무가설 참 –&gt; 기각 (오류)<br />
귀무가설 거짓 –&gt; 채택 (오류)<br />
귀무가설 거짓 –&gt; 기각 (o)</p>
<p>앞서 재판의 경우를 예로 들면 제1종오류는 죄가 없는 사람(<span class="math inline">\(H_0\)</span>가 참)을 죄가 있다고 판단 (<span class="math inline">\(H_0\)</span>기각) 하는 경우로 가능하면 일어나서는 안되는 상황입니다. 따라서 <span class="math inline">\(\alpha\)</span>는 보수적인 기준으로 정하게 되나 <span class="math inline">\(\alpha\)</span>가 작아지면 자동적으로 <span class="math inline">\(\beta\)</span>가 큰 값으로 결정되어 두 오류를 동시에 작게 만족시키는 유의수준은 정하기 어렵습니다. 따라서 가능한 제1종 오류를 작게 유지하면서 power (<span class="math inline">\(1-\beta\)</span>)를 가능한 높게 되도록 검정을 디자인할 필요가 있습니다.</p>
<p><strong>[Example]</strong> 어떤 기계의 영점이 N(0,1)의 분포를 가지고 영점이 맞지 않을 경우 N(1,1)의 분포를 가진다고 한다. 기계로 부터 측정한 값이 0.7일 경우 기계의 영점이 맞춰져 있는지 아닌지를 판단하시오</p>
<p><span class="math display">\[
H_0: \mu = 0 \text{ vs } H_1: \mu = 1
\]</span></p>
<p><img src="images/09/03.png" /></p>
<p>만약 영점이 맞춰진 상태에서 관측된 값이라면 <span class="math inline">\(Z = {0.7-\mu}/sd = 0.7\)</span> 이므로 p-value는 <code>1-pnorm(0.7, 0, 1)=0.2419</code> 이므로 가설을 기각할만한 증거가 충분치 않습니다. 즉, <span class="math inline">\(H_0: \mu=0\)</span>를 받아들이는 상황인 것인데 그렇지만 0.7은 분명히 0보다는 1에 가까운 (<span class="math inline">\(H_1\)</span>) 값입니다. 이러한 경우에 1 sd 대신 1/sqrt(10) 값을 사용하면 훨씬더 명확한 판단을 내릴 수 있습니다.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="significance-test.html#cb195-1"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="fl">0.7</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>))</span></code></pre></div>
<p>즉, p-value가 충분히 작으므로 귀무가설 <span class="math inline">\(H_0\)</span>를 기각하고 대립가설을 지지하게 됩니다. 1 standard deviation unit 대신 1/10 unit을 사용함므로써 더욱 명확한 판단을 내릴 수 있게 된 것입니다.</p>
<p>위와 같은 p-value는 가설을 검정하는데 사용되는 핵심 기준이 되며 가설을 검정하기위한 p-value 계산법은 일반적으로 다음과 같습니다.</p>
<ul>
<li>데이터에 맞는 분포를 정함 (모수 정의)</li>
<li>H0와 H1를 정함</li>
<li>검정 통계량 정의</li>
<li>데이터 수집</li>
<li>검정 통계량 계산</li>
<li>p-value 계산</li>
</ul>
<p>유의성 검정의 목적은 추정한 모수가 얼마나 통계적으로 유의한지를 판단하기 위한 것 입니다. 모형에 (분포) 따라서 모수가 달라지므로 다음과 같이 몇 가지 경우에 대한 유의성 검정 방법들이 있습니다.</p>
<div id="significance-test-for-a-population-proportion" class="section level2">
<h2><span class="header-section-number">9.1</span> Significance test for a population proportion</h2>
<p>실업률 고용률 오르는지, 빈곤율 떨어지는지 등 비율에 대한 값이 있고 이러한 모수를 갖는 분포는 이항분포가 대표적인 예 입니다. 해당 분포에 대한 모수가 관측한 값보다 더 높은지 낮은지를 비교하는 검정을 수행할 수 있습니다. 위 기준이 되는 값을 <span class="math inline">\(p_0\)</span>라 하고 우리의 관심을 <span class="math inline">\(p\)</span>라 하고 만약 <span class="math inline">\(n\)</span> 번 관찰 중 <span class="math inline">\(x\)</span>번을 성공 횟수라 한다면 <span class="math inline">\(\hat{p} = x/n\)</span> 입니다. 보통은 표준화한 값을 통계량으로 사용하고 <span class="math inline">\(Z\)</span>는 다음과 같습니다.</p>
<p><span class="math display">\[
\begin{split}
H_0: p = p_0 \\
H_1: p &gt; p_0, H_1: p &lt; p_0, H_1: p \neq p_0 \\
Z = \frac{\hat{p} - E(\hat{p}|H_0)}{SD(\hat{p}|H_0)} = \frac{\hat{p} - p_0}{\sqrt{p_0(1-p_0)/n}} 
\end{split}
\]</span></p>
<div class="figure">
<img src="images/09/04.png" alt="" />
<p class="caption">page300 Figure 9.2</p>
</div>
<div class="figure">
<img src="images/09/05.png" alt="" />
<p class="caption">page300 Equation 9.1</p>
</div>
<p><strong>[Example]</strong> 2000년 빈곤율은 11.7% 였고 2010년 빈곤율은 15.0% 였다. 2011년 빈곤율이 15.13%으로 관측 되었을 때 빈곤율이 증가하는 것인지 검정하시오. n = 150,000.</p>
<ul>
<li>분포 - 비율 비교 (이항분포)</li>
<li>H0: 15.0과 같다, H1: 15.0보다 크다</li>
<li>통계량: Z</li>
<li>통계량, pvalue계산</li>
</ul>
<p><span class="math display">\[
\begin{split}
&amp; H_0: p = 0.15 \\
&amp; H_1: p &gt; 0.15 \\
Z &amp;= \frac{0.1513 - 0.15}{\sqrt{0.1513 \times 0.8487 / 150000}} = 1.405 \sim N(0,1)
\end{split}
\]</span></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="significance-test.html#cb196-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb196-2"><a href="significance-test.html#cb196-2"></a></span>
<span id="cb196-3"><a href="significance-test.html#cb196-3"></a>phat &lt;-<span class="st"> </span><span class="fl">0.1513</span></span>
<span id="cb196-4"><a href="significance-test.html#cb196-4"></a>p0 &lt;-<span class="st"> </span><span class="fl">0.15</span></span>
<span id="cb196-5"><a href="significance-test.html#cb196-5"></a>n &lt;-<span class="st"> </span><span class="dv">150000</span></span>
<span id="cb196-6"><a href="significance-test.html#cb196-6"></a>SD &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0)<span class="op">/</span>n)</span>
<span id="cb196-7"><a href="significance-test.html#cb196-7"></a>Z &lt;-<span class="st"> </span>(phat <span class="op">-</span><span class="st"> </span>p0)<span class="op">/</span>SD</span>
<span id="cb196-8"><a href="significance-test.html#cb196-8"></a>pval &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(Z)</span>
<span id="cb196-9"><a href="significance-test.html#cb196-9"></a></span>
<span id="cb196-10"><a href="significance-test.html#cb196-10"></a><span class="co">## plot</span></span>
<span id="cb196-11"><a href="significance-test.html#cb196-11"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length=</span><span class="dv">100</span>)</span>
<span id="cb196-12"><a href="significance-test.html#cb196-12"></a>y &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x)</span>
<span id="cb196-13"><a href="significance-test.html#cb196-13"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)</span>
<span id="cb196-14"><a href="significance-test.html#cb196-14"></a></span>
<span id="cb196-15"><a href="significance-test.html#cb196-15"></a>x1 &lt;-<span class="st"> </span><span class="kw">seq</span>(Z, <span class="dv">5</span>, <span class="dt">length=</span><span class="dv">50</span>)</span>
<span id="cb196-16"><a href="significance-test.html#cb196-16"></a>y1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x1)</span>
<span id="cb196-17"><a href="significance-test.html#cb196-17"></a>dat2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(Z, x1, Z), <span class="dt">y=</span><span class="kw">c</span>(<span class="dv">0</span>, y1, <span class="dv">0</span>))</span>
<span id="cb196-18"><a href="significance-test.html#cb196-18"></a></span>
<span id="cb196-19"><a href="significance-test.html#cb196-19"></a><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb196-20"><a href="significance-test.html#cb196-20"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb196-21"><a href="significance-test.html#cb196-21"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">dat=</span>dat2, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb196-22"><a href="significance-test.html#cb196-22"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="kw">round</span>(pval,<span class="dv">3</span>), <span class="dt">x =</span> <span class="dv">3</span>, <span class="dt">y =</span> <span class="fl">0.15</span>, <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb196-23"><a href="significance-test.html#cb196-23"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="fl">2.5</span>, <span class="dt">y =</span> <span class="fl">0.12</span>, <span class="dt">xend =</span> <span class="fl">1.8</span>, <span class="dt">yend =</span> <span class="fl">0.05</span>),  <span class="dt">arrow =</span> <span class="kw">arrow</span>(), <span class="dt">color=</span><span class="st">&#39;red&#39;</span>,<span class="dt">size=</span><span class="dv">1</span>)</span></code></pre></div>
<p><strong>[EXERCISE]</strong> 앞서 예제를 <code>prop.test</code> 를 사용해서 구현하시오</p>
</div>
<div id="significance-test-for-the-mean-t-test" class="section level2">
<h2><span class="header-section-number">9.2</span> Significance test for the mean (t-test)</h2>
<p>이번에는 미지의 모평균에 대한 검정을 수행하는 방법을 알아봅니다. 검정 방법은 앞서 배운 비율 검정 과정과 유사하며 통계량은 신뢰구간을 학습할 때 배웠던 계산식과 같습니다.</p>
<p><span class="math display">\[
\begin{split}
H_0: \mu = \mu_0 \\
H_1: \mu &gt; \mu_0, H_1: \mu &lt; \mu_0, H_1: \mu \neq \mu_0 \\
T = \frac{\bar{x} - E(\bar{x}|H_0)}{SE(\bar{x}|H_0)} = \frac{\bar{x} - \mu_0}{s / \sqrt{n}} = \frac{\text{observed} - \text{expected}}{SE} 
\end{split}
\]</span></p>
<p>이제 데이터 <span class="math inline">\(x_1, x_2, ..., x_n\)</span>을 얻고 이로부터 <span class="math inline">\(t = (\bar{x}-\mu_0)/(s/\sqrt{n})\)</span>을 구할 경우 p-value는 다음과 같습니다.</p>
<div class="figure">
<img src="images/09/06.png" alt="" />
<p class="caption">page304</p>
</div>
<p><strong>[Example]</strong> 새 SUV 자동차의 연비가 17miles / gallon 으로 알려져 있다. 소비자 그룹에서는 그러나 이보다 낮은 것으로 의심하고 있다. 다음 데이터들이 관측 되었을 때 해당 신차의 연비가 17mile 보다 작은지 검정하시오.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="significance-test.html#cb197-1"></a>mpg &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">11.4</span>, <span class="fl">13.1</span>, <span class="fl">14.7</span>, <span class="fl">14.7</span>, <span class="dv">15</span>, <span class="fl">15.5</span>, <span class="fl">15.6</span>, <span class="fl">15.9</span>, <span class="dv">16</span>, <span class="fl">16.8</span>)</span>
<span id="cb197-2"><a href="significance-test.html#cb197-2"></a>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(mpg)</span>
<span id="cb197-3"><a href="significance-test.html#cb197-3"></a>s &lt;-<span class="st"> </span><span class="kw">sd</span>(mpg)</span>
<span id="cb197-4"><a href="significance-test.html#cb197-4"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(mpg)</span>
<span id="cb197-5"><a href="significance-test.html#cb197-5"></a>tstat &lt;-<span class="st"> </span>(xbar<span class="dv">-17</span>)<span class="op">/</span>(s<span class="op">/</span><span class="kw">sqrt</span>(n))</span></code></pre></div>
<p><span class="math display">\[
\begin{split}
&amp;H_0: \mu = 17 \\
&amp;H_1: \mu &lt; 17 \\
T &amp;= \frac{14.87 - 17}{1.582 / 3.162} =  -4.284
\end{split}
\]</span></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="significance-test.html#cb198-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb198-2"><a href="significance-test.html#cb198-2"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length=</span><span class="dv">100</span>)</span>
<span id="cb198-3"><a href="significance-test.html#cb198-3"></a>y &lt;-<span class="st"> </span><span class="kw">dt</span>(x, <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb198-4"><a href="significance-test.html#cb198-4"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)</span>
<span id="cb198-5"><a href="significance-test.html#cb198-5"></a><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb198-6"><a href="significance-test.html#cb198-6"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb198-7"><a href="significance-test.html#cb198-7"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> tstat)</span></code></pre></div>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="significance-test.html#cb199-1"></a><span class="kw">pt</span>(tstat, <span class="dt">df=</span><span class="dv">9</span>, <span class="dt">lower.tail=</span>T)</span></code></pre></div>
<p><strong>[EXERCISE]</strong> 위 예제를 <code>t.test</code> 를 사용해서 구현하시오</p>
</div>
<div id="two-sample-test-of-proportion" class="section level2">
<h2><span class="header-section-number">9.3</span> Two sample test of proportion</h2>
<div class="figure">
<img src="images/09/07.png" alt="" />
<p class="caption">Two sample tests of proportion</p>
</div>
<p><strong>[Example]</strong> 2010년 빈곤율을 160000명에 대해 조사한 결과 15.0% 였다. 2011년 빈곤율은 150000명에 대해 조사해서 15.13%으로 관측 되었을 때 두 빈곤율이 유의한 차이가 있는 것인가?</p>
<ul>
<li>분포 - 비율 비교</li>
<li>H0: 2010년과 2011년 빈곤율은 같다. H1: Not H0</li>
<li>통계량: Z</li>
<li>통계량, pvalue계산</li>
</ul>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="significance-test.html#cb200-1"></a>phat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1513</span>)</span>
<span id="cb200-2"><a href="significance-test.html#cb200-2"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">160000</span>, <span class="dv">150000</span>)</span>
<span id="cb200-3"><a href="significance-test.html#cb200-3"></a>n<span class="op">*</span>phat</span></code></pre></div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="significance-test.html#cb201-1"></a><span class="kw">prop.test</span>(n<span class="op">*</span>phat, n, <span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
</div>
<div id="two-sample-test-of-center" class="section level2">
<h2><span class="header-section-number">9.4</span> Two sample test of center</h2>
<div class="figure">
<img src="images/09/08.png" alt="" />
<p class="caption">Two sample tests of center (t-test)</p>
</div>
<p><strong>[Example]</strong> HIV의 항바이러스제 AZT는 하루 300mg 효과가 있고 그 이상은 부작용이 나타난다고 알려짐. 그러나 높은 농도에서 약효가 더 좋은지를 검정하고자 함. 측정값은 면역반응을 증가시키는 p24 농도를 측정한 값임.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="significance-test.html#cb202-1"></a>m300 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">284</span>, <span class="dv">279</span>, <span class="dv">289</span>, <span class="dv">292</span>, <span class="dv">287</span>, <span class="dv">295</span>, <span class="dv">285</span>, <span class="dv">279</span>, <span class="dv">306</span>, <span class="dv">298</span>)</span>
<span id="cb202-2"><a href="significance-test.html#cb202-2"></a>m600 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">298</span>, <span class="dv">307</span>, <span class="dv">297</span>, <span class="dv">279</span>, <span class="dv">291</span>, <span class="dv">335</span>, <span class="dv">299</span>, <span class="dv">300</span>, <span class="dv">306</span>, <span class="dv">291</span>)</span>
<span id="cb202-3"><a href="significance-test.html#cb202-3"></a><span class="kw">t.test</span>(m300, m600) </span>
<span id="cb202-4"><a href="significance-test.html#cb202-4"></a><span class="kw">t.test</span>(m300, m600, <span class="dt">var.equal=</span>T) </span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="significance-test.html#cb203-1"></a><span class="kw">plot</span>(<span class="kw">density</span>(m300)); <span class="kw">lines</span>(<span class="kw">density</span>(m600), <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><strong>[Example]</strong> (Paired data) 특정 코스웍이 효과가 있는지를 검증하고자 하는 연구로서 한 학생에 대해서 강의를 듣기 전과 후의 효과를 측정하여 검정을 수행함</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="significance-test.html#cb204-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">3</span>)</span>
<span id="cb204-2"><a href="significance-test.html#cb204-2"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb204-3"><a href="significance-test.html#cb204-3"></a><span class="kw">t.test</span>(x, y)</span>
<span id="cb204-4"><a href="significance-test.html#cb204-4"></a>z &lt;-<span class="st"> </span>x<span class="op">-</span>y</span>
<span id="cb204-5"><a href="significance-test.html#cb204-5"></a><span class="kw">t.test</span>(z)</span>
<span id="cb204-6"><a href="significance-test.html#cb204-6"></a><span class="kw">t.test</span>(x, y, <span class="dt">paired =</span> T)</span></code></pre></div>
</div>
<div id="association-for-categorical-data" class="section level2">
<h2><span class="header-section-number">9.5</span> Association for categorical data</h2>
<p>앞서 chapter 4에서 범주형 데이터와 함께 The chi-squared statistics의 간략한 설명이 있었습니다. The chi-squared statistics 는 가장 널리 쓰이는 범주형 자료의 연관성 척도로 다음과 같이 정의됩니다. 수식의 “o”와 “e”는 각각 관측값과 예측값을 나타내며 이 값이 클 경우 연관이 크다는 것 입니다.</p>
<p><span class="math display">\[ \text{chi-squared statistic } = \sum \frac{(f_o - f_e)^2}{f_e} \]</span></p>
<p><strong>[Example]</strong> 다음 seatbelt 데이터에서 만약 부모와 아이들의 안전벨트를 매는 두 사건 (변수)가 독립이라면 <span class="math inline">\(p(C, P) == p(C)p(P)\)</span> 즉, 결합확률이 각 확률을 곱한 것과 같고 기대값은 확률 x 전체 사건의 수(<span class="math inline">\(N\)</span>) 이므로 다시 적으면 <span class="math inline">\(N p(C,P) == N p(C)p(P)\)</span>임. 여기서 <span class="math inline">\(N p(C,P)\)</span>는 우리가 관측한 값으로 볼 수 있고 <span class="math inline">\(N p(C) p(P)\)</span>는 독립을 가정한 상태에서 기대값이라고 볼 수 있음.</p>
<p><img src="images/03/15.png" /></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="significance-test.html#cb205-1"></a>fo &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">56</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">16</span>), <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb205-2"><a href="significance-test.html#cb205-2"></a><span class="kw">rownames</span>(fo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;buckled&quot;</span>,<span class="st">&quot;unbuckled&quot;</span>)</span>
<span id="cb205-3"><a href="significance-test.html#cb205-3"></a><span class="kw">colnames</span>(fo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;buckled&quot;</span>,<span class="st">&quot;unbuckled&quot;</span>)</span>
<span id="cb205-4"><a href="significance-test.html#cb205-4"></a></span>
<span id="cb205-5"><a href="significance-test.html#cb205-5"></a><span class="co">## marginal probability</span></span>
<span id="cb205-6"><a href="significance-test.html#cb205-6"></a>margin_rows &lt;-<span class="st"> </span><span class="kw">rowSums</span>(fo)<span class="op">/</span><span class="kw">sum</span>(fo)</span>
<span id="cb205-7"><a href="significance-test.html#cb205-7"></a>margin_cols &lt;-<span class="st"> </span><span class="kw">colSums</span>(fo)<span class="op">/</span><span class="kw">sum</span>(fo)</span>
<span id="cb205-8"><a href="significance-test.html#cb205-8"></a></span>
<span id="cb205-9"><a href="significance-test.html#cb205-9"></a><span class="co">## expected numbers</span></span>
<span id="cb205-10"><a href="significance-test.html#cb205-10"></a>fe &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb205-11"><a href="significance-test.html#cb205-11"></a>fe[<span class="dv">1</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[<span class="dv">1</span>]<span class="op">*</span>margin_cols[<span class="dv">1</span>]</span>
<span id="cb205-12"><a href="significance-test.html#cb205-12"></a>fe[<span class="dv">1</span>,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[<span class="dv">1</span>]<span class="op">*</span>margin_cols[<span class="dv">2</span>]</span>
<span id="cb205-13"><a href="significance-test.html#cb205-13"></a>fe[<span class="dv">2</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[<span class="dv">2</span>]<span class="op">*</span>margin_cols[<span class="dv">1</span>]</span>
<span id="cb205-14"><a href="significance-test.html#cb205-14"></a>fe[<span class="dv">2</span>,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[<span class="dv">2</span>]<span class="op">*</span>margin_cols[<span class="dv">2</span>]</span>
<span id="cb205-15"><a href="significance-test.html#cb205-15"></a><span class="co">#fe</span></span>
<span id="cb205-16"><a href="significance-test.html#cb205-16"></a></span>
<span id="cb205-17"><a href="significance-test.html#cb205-17"></a><span class="co">## use chisq.test function</span></span>
<span id="cb205-18"><a href="significance-test.html#cb205-18"></a><span class="co">#(fo-fe)^2 / fe</span></span>
<span id="cb205-19"><a href="significance-test.html#cb205-19"></a>chistat &lt;-<span class="st"> </span><span class="kw">sum</span>((fo<span class="op">-</span>fe)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>fe)</span>
<span id="cb205-20"><a href="significance-test.html#cb205-20"></a>df &lt;-<span class="st"> </span>(<span class="kw">nrow</span>(fo)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">ncol</span>(fo)<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb205-21"><a href="significance-test.html#cb205-21"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(chistat, df)</span>
<span id="cb205-22"><a href="significance-test.html#cb205-22"></a></span>
<span id="cb205-23"><a href="significance-test.html#cb205-23"></a></span>
<span id="cb205-24"><a href="significance-test.html#cb205-24"></a>result &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(fo)</span></code></pre></div>
<p><img src="images/09/09.png" /></p>
<p><strong>[Example]</strong> 한 의학연구가에 의하면 흡연은 눈가에 주름이 지게 하는 요인이 된다고 한다. 이러한 주장이 타당한가를 알아보기 위해 30대 남자 1000명을 랜덤하게 추출하여 조사한 결과 다음과 같은 표를 얻었다. 30대 남자들을 대상으로 볼 때 연구가의 주장이 옳은지 판단하는 연관성을 나타내는 카이제곱 값을 구하라</p>
<p><img src="images/09/10.png" /></p>
<p>chistat = 74.9652, pvalue&lt;2.2E-16</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="significance-test.html#cb206-1"></a>fo &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">186</span>, <span class="dv">228</span>, <span class="dv">114</span>, <span class="dv">472</span>), <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb206-2"><a href="significance-test.html#cb206-2"></a>fo</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  186  114
## [2,]  228  472</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="significance-test.html#cb208-1"></a><span class="kw">chisq.test</span>(fo, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## 	Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  fo
## X-squared = 73.757, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div id="variable-type-and-testing-methods" class="section level2">
<h2><span class="header-section-number">9.6</span> Variable type and testing methods</h2>
<p><img src="images/09/11.png" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-inference.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
