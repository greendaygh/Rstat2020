<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 R graphics basics | R 프로그래밍과 데이터 분석</title>
  <meta name="description" content="UST lecture web site" />
  <meta name="generator" content="bookdown 0.16.5 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 R graphics basics | R 프로그래밍과 데이터 분석" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="UST lecture web site" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 R graphics basics | R 프로그래밍과 데이터 분석" />
  
  <meta name="twitter:description" content="UST lecture web site" />
  

<meta name="author" content="한국생명공학연구원 김하성" />


<meta name="date" content="2020-06-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-programming-basics-ii.html"/>
<link rel="next" href="r-graphics-ggplot2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">[2020 UST Lecture] R programming</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction 강의 개요</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#goal-강의-목표"><i class="fa fa-check"></i><b>1.1</b> Goal 강의 목표</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#this-course"><i class="fa fa-check"></i><b>1.2</b> This course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#tips"><i class="fa fa-check"></i><b>1.3</b> Tips</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#references-books-참고-교제"><i class="fa fa-check"></i><b>1.4</b> References books 참고 교제</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references-참고-자료"><i class="fa fa-check"></i><b>1.5</b> References 참고 자료</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#evaluation-평가-세부-항목"><i class="fa fa-check"></i><b>1.6</b> Evaluation 평가 세부 항목</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#schedule-강의-계획"><i class="fa fa-check"></i><b>1.7</b> Schedule 강의 계획</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#r-lecture-youtube-link"><i class="fa fa-check"></i><b>1.8</b> R Lecture Youtube Link</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#lecture-chapter-3"><i class="fa fa-check"></i><b>1.8.1</b> Lecture Chapter 3</a></li>
<li class="chapter" data-level="1.8.2" data-path="index.html"><a href="index.html#lecture-chapter-4"><i class="fa fa-check"></i><b>1.8.2</b> Lecture Chapter 4</a></li>
<li class="chapter" data-level="1.8.3" data-path="index.html"><a href="index.html#lecture-chapter-5"><i class="fa fa-check"></i><b>1.8.3</b> Lecture Chapter 5</a></li>
<li class="chapter" data-level="1.8.4" data-path="index.html"><a href="index.html#lecture-chapter-6"><i class="fa fa-check"></i><b>1.8.4</b> Lecture Chapter 6</a></li>
<li class="chapter" data-level="1.8.5" data-path="index.html"><a href="index.html#lecture-chapter-7"><i class="fa fa-check"></i><b>1.8.5</b> Lecture Chapter 7</a></li>
<li class="chapter" data-level="1.8.6" data-path="index.html"><a href="index.html#lecture-chapter-8"><i class="fa fa-check"></i><b>1.8.6</b> Lecture Chapter 8</a></li>
<li class="chapter" data-level="1.8.7" data-path="index.html"><a href="index.html#lecture-chapter-9"><i class="fa fa-check"></i><b>1.8.7</b> Lecture Chapter 9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> R basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-basics.html"><a href="r-basics.html#what-is-r-rstudio"><i class="fa fa-check"></i><b>2.1</b> What is R / Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="r-basics.html"><a href="r-basics.html#r-rstudio-installation"><i class="fa fa-check"></i><b>2.2</b> R / Rstudio installation</a></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html#rstudio-interface"><i class="fa fa-check"></i><b>2.3</b> Rstudio interface</a></li>
<li class="chapter" data-level="2.4" data-path="r-basics.html"><a href="r-basics.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4</b> Keyboard shortcuts</a></li>
<li class="chapter" data-level="2.5" data-path="r-basics.html"><a href="r-basics.html#set-working-directory"><i class="fa fa-check"></i><b>2.5</b> Set working directory</a></li>
<li class="chapter" data-level="2.6" data-path="r-basics.html"><a href="r-basics.html#hello-world"><i class="fa fa-check"></i><b>2.6</b> Hello world</a></li>
<li class="chapter" data-level="2.7" data-path="r-basics.html"><a href="r-basics.html#help"><i class="fa fa-check"></i><b>2.7</b> Help</a></li>
<li class="chapter" data-level="2.8" data-path="r-basics.html"><a href="r-basics.html#rstudio-workspace"><i class="fa fa-check"></i><b>2.8</b> RStudio workspace</a></li>
<li class="chapter" data-level="2.9" data-path="r-basics.html"><a href="r-basics.html#r-packages"><i class="fa fa-check"></i><b>2.9</b> R packages</a></li>
<li class="chapter" data-level="2.10" data-path="r-basics.html"><a href="r-basics.html#data-sets"><i class="fa fa-check"></i><b>2.10</b> Data sets</a></li>
<li class="chapter" data-level="2.11" data-path="r-basics.html"><a href="r-basics.html#cheatsheet"><i class="fa fa-check"></i><b>2.11</b> Cheatsheet</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html"><i class="fa fa-check"></i><b>3</b> R programming basics I</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#terminology"><i class="fa fa-check"></i><b>3.1</b> Terminology</a></li>
<li class="chapter" data-level="3.2" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#r-console-script"><i class="fa fa-check"></i><b>3.2</b> R console script</a></li>
<li class="chapter" data-level="3.3" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#what-is-a-programming-language"><i class="fa fa-check"></i><b>3.3</b> What is a programming language</a></li>
<li class="chapter" data-level="3.4" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#variables-and-values"><i class="fa fa-check"></i><b>3.4</b> Variables and values</a></li>
<li class="chapter" data-level="3.5" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#object-variable-type-of-storage-mode"><i class="fa fa-check"></i><b>3.5</b> Object (variable) type of (storage) mode</a></li>
<li class="chapter" data-level="3.6" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#levels-of-measurement"><i class="fa fa-check"></i><b>3.6</b> Levels of measurement</a></li>
<li class="chapter" data-level="3.7" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#object---vectors"><i class="fa fa-check"></i><b>3.7</b> Object - Vectors</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#exercise-3-1"><i class="fa fa-check"></i><b>3.7.1</b> Exercise 3-1</a></li>
<li class="chapter" data-level="3.7.2" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#exercise-3-2"><i class="fa fa-check"></i><b>3.7.2</b> Exercise 3-2</a></li>
<li class="chapter" data-level="3.7.3" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#exercise-3-3"><i class="fa fa-check"></i><b>3.7.3</b> Exercise 3-3</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#object---matrix"><i class="fa fa-check"></i><b>3.8</b> Object - matrix</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#exercise-3-4"><i class="fa fa-check"></i><b>3.8.1</b> Exercise 3-4</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#object---data.frame"><i class="fa fa-check"></i><b>3.9</b> Object - data.frame</a></li>
<li class="chapter" data-level="3.10" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#object---list"><i class="fa fa-check"></i><b>3.10</b> Object - list</a></li>
<li class="chapter" data-level="3.11" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#missing-values"><i class="fa fa-check"></i><b>3.11</b> Missing values</a></li>
<li class="chapter" data-level="3.12" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#useful-functions-i"><i class="fa fa-check"></i><b>3.12</b> Useful functions I</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="r-programming-basics-i.html"><a href="r-programming-basics-i.html#exercise-3-5"><i class="fa fa-check"></i><b>3.12.1</b> Exercise 3-5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html"><i class="fa fa-check"></i><b>4</b> R programming basics II</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#a-script-in-r"><i class="fa fa-check"></i><b>4.1</b> A script in R</a></li>
<li class="chapter" data-level="4.2" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#functions"><i class="fa fa-check"></i><b>4.2</b> Functions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#exercise-4-1"><i class="fa fa-check"></i><b>4.2.1</b> Exercise 4-1</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#vectorized-functions"><i class="fa fa-check"></i><b>4.3</b> Vectorized functions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#exercise-4-2"><i class="fa fa-check"></i><b>4.3.1</b> Exercise 4-2</a></li>
<li class="chapter" data-level="4.3.2" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#exercise-4-3"><i class="fa fa-check"></i><b>4.3.2</b> Exercise 4-3</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#if-statements"><i class="fa fa-check"></i><b>4.4</b> if statements</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#exercise-4-4"><i class="fa fa-check"></i><b>4.4.1</b> Exercise 4-4</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#for-while-repeat"><i class="fa fa-check"></i><b>4.5</b> for, while, repeat</a></li>
<li class="chapter" data-level="4.6" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#avoiding-loops"><i class="fa fa-check"></i><b>4.6</b> Avoiding Loops</a></li>
<li class="chapter" data-level="4.7" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#object-oriented-programming-advanced"><i class="fa fa-check"></i><b>4.7</b> Object Oriented Programming (Advanced)</a></li>
<li class="chapter" data-level="4.8" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#usuful-functions-ii"><i class="fa fa-check"></i><b>4.8</b> Usuful functions II</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#exercise-4-5"><i class="fa fa-check"></i><b>4.8.1</b> Exercise 4-5</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#file-read-and-write"><i class="fa fa-check"></i><b>4.9</b> File read and write</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#exercise-4-6"><i class="fa fa-check"></i><b>4.9.1</b> Exercise 4-6</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#excel-file-read-and-data-plotting"><i class="fa fa-check"></i><b>4.10</b> Excel file read and data plotting</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="r-programming-basics-ii.html"><a href="r-programming-basics-ii.html#exercise-4-7-barplot-with-error-bars"><i class="fa fa-check"></i><b>4.10.1</b> Exercise 4-7 barplot with error bars</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html"><i class="fa fa-check"></i><b>5</b> R graphics basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#scatter-plot"><i class="fa fa-check"></i><b>5.1</b> scatter plot</a></li>
<li class="chapter" data-level="5.2" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#histogram"><i class="fa fa-check"></i><b>5.2</b> histogram</a></li>
<li class="chapter" data-level="5.3" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#boxplot"><i class="fa fa-check"></i><b>5.3</b> boxplot</a></li>
<li class="chapter" data-level="5.4" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#barplot"><i class="fa fa-check"></i><b>5.4</b> barplot</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#exercise-5-1"><i class="fa fa-check"></i><b>5.4.1</b> Exercise 5-1</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#draw-multiple-graphs-in-the-same-plot"><i class="fa fa-check"></i><b>5.5</b> Draw multiple graphs in the same plot</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#exercise-5-2"><i class="fa fa-check"></i><b>5.5.1</b> Exercise 5-2</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="r-graphics-basics.html"><a href="r-graphics-basics.html#barplot-for-multiplate-reader-data"><i class="fa fa-check"></i><b>5.6</b> Barplot for multiplate reader data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html"><i class="fa fa-check"></i><b>6</b> R graphics ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#basics"><i class="fa fa-check"></i><b>6.1</b> Basics</a></li>
<li class="chapter" data-level="6.2" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#exercise-6.1"><i class="fa fa-check"></i><b>6.2.1</b> Exercise 6.1</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#bar-graph"><i class="fa fa-check"></i><b>6.3</b> Bar graph</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#exercise-6.2"><i class="fa fa-check"></i><b>6.3.1</b> Exercise 6.2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#line-graph"><i class="fa fa-check"></i><b>6.4</b> Line graph</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#exercise-6.3"><i class="fa fa-check"></i><b>6.4.1</b> Exercise 6.3</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#smoothing"><i class="fa fa-check"></i><b>6.5</b> Smoothing</a></li>
<li class="chapter" data-level="6.6" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#statstics-and-positions"><i class="fa fa-check"></i><b>6.6</b> Statstics and positions</a></li>
<li class="chapter" data-level="6.7" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#themes-labels-and-scales"><i class="fa fa-check"></i><b>6.7</b> Themes, Labels, and Scales</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="r-graphics-ggplot2.html"><a href="r-graphics-ggplot2.html#exercise-6.4"><i class="fa fa-check"></i><b>6.7.1</b> Exercise 6.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html"><i class="fa fa-check"></i><b>7</b> Data transformation basics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#subset-and-filter"><i class="fa fa-check"></i><b>7.1</b> subset and filter</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#exercise-7.1"><i class="fa fa-check"></i><b>7.1.1</b> Exercise 7.1</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#merging-and-split"><i class="fa fa-check"></i><b>7.2</b> merging and split</a></li>
<li class="chapter" data-level="7.3" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#transforming-data"><i class="fa fa-check"></i><b>7.3</b> transforming data</a></li>
<li class="chapter" data-level="7.4" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#analysis-example-babies"><i class="fa fa-check"></i><b>7.4</b> Analysis example (babies)</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#exercise-7.2"><i class="fa fa-check"></i><b>7.4.1</b> Exercise 7.2</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#apply"><i class="fa fa-check"></i><b>7.5</b> apply</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#exercise-7.3"><i class="fa fa-check"></i><b>7.5.1</b> Exercise 7.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html"><i class="fa fa-check"></i><b>8</b> Data transformation with dplyr</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#long-and-wide-data-structure"><i class="fa fa-check"></i><b>8.1</b> Long and wide data structure</a></li>
<li class="chapter" data-level="8.2" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#dplyr---pipe-operator"><i class="fa fa-check"></i><b>8.2</b> dplyr - pipe operator</a></li>
<li class="chapter" data-level="8.3" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#dplyr---important-functions"><i class="fa fa-check"></i><b>8.3</b> dplyr - Important functions</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#filter"><i class="fa fa-check"></i><b>8.3.1</b> filter</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>8.3.2</b> arrange</a></li>
<li class="chapter" data-level="8.3.3" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#select"><i class="fa fa-check"></i><b>8.3.3</b> select</a></li>
<li class="chapter" data-level="8.3.4" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#mutate"><i class="fa fa-check"></i><b>8.3.4</b> mutate</a></li>
<li class="chapter" data-level="8.3.5" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#summarise"><i class="fa fa-check"></i><b>8.3.5</b> summarise</a></li>
<li class="chapter" data-level="8.3.6" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#join"><i class="fa fa-check"></i><b>8.3.6</b> join</a></li>
<li class="chapter" data-level="8.3.7" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#code-comparison"><i class="fa fa-check"></i><b>8.3.7</b> code comparison</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#dplyr-example-iris"><i class="fa fa-check"></i><b>8.4</b> dplyr example iris</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exercise-class.html"><a href="exercise-class.html"><i class="fa fa-check"></i><b>9</b> Exercise class</a>
<ul>
<li class="chapter" data-level="9.1" data-path="exercise-class.html"><a href="exercise-class.html#exercise-7.3-1"><i class="fa fa-check"></i><b>9.1</b> Exercise 7.3</a></li>
<li class="chapter" data-level="9.2" data-path="exercise-class.html"><a href="exercise-class.html#exercise-9.1"><i class="fa fa-check"></i><b>9.2</b> Exercise 9.1</a></li>
<li class="chapter" data-level="9.3" data-path="exercise-class.html"><a href="exercise-class.html#exercise-9.2"><i class="fa fa-check"></i><b>9.3</b> Exercise 9.2</a></li>
<li class="chapter" data-level="9.4" data-path="exercise-class.html"><a href="exercise-class.html#exercise-9.3"><i class="fa fa-check"></i><b>9.4</b> Exercise 9.3</a></li>
<li class="chapter" data-level="9.5" data-path="exercise-class.html"><a href="exercise-class.html#exercise-9.4"><i class="fa fa-check"></i><b>9.5</b> Exercise 9.4</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 프로그래밍과 데이터 분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-graphics-basics" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> R graphics basics</h1>
<p>이번 시간에는 R에서 제공하는 기본 그래프 함수들을 간략하게 알아보고 지난 강의에서 간략하게 실습했던 multiple plate reader (<span class="math inline">\(Victor^{TM}\)</span>, PerkinElmer, Inc.) 장비를 통해 측정된 데이터를 읽어와서 분석하기 위한 함수를 작성해 보겠습니다.</p>
<div id="scatter-plot" class="section level2">
<h2><span class="header-section-number">5.1</span> scatter plot</h2>
<p>R에서 plot 함수는 가장 기본이 되는 그래프 함수 입니다. 아래는 산포도를 그려주는 코드로서 myxy가 두 개의 변수(x1과 y1)를 가지고 있으므로 아래 명령들은 모두 같은 그림을 그려주게 됩니다. 가장 마지막 명령은 <code>formula</code>를 사용한 plot으로 첫번째 파라메터 인자로 <code>formula</code> 타입이 전달되면 plot.formula 함수가 실행되며 x, y 값이 전달될 경우 <code>plot.default</code> 함수가 수행됩니다. R에서는 이렇게 전달되는 파라메터의 타입에 따라서 다른 기능을 하는 함수를 <code>Generic function</code> 이라고 합니다. 만약 기존 그림에 추가 데이터의 산포를 그리고 싶은 경우 <code>points</code>라는 함수를 사용합니다.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="r-graphics-basics.html#cb55-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</span>
<span id="cb55-2"><a href="r-graphics-basics.html#cb55-2"></a>y &lt;-<span class="st"> </span>x<span class="op">*</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb55-3"><a href="r-graphics-basics.html#cb55-3"></a>myxy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x,y)</span>
<span id="cb55-4"><a href="r-graphics-basics.html#cb55-4"></a><span class="kw">plot</span>(myxy)</span>
<span id="cb55-5"><a href="r-graphics-basics.html#cb55-5"></a><span class="kw">plot</span>(myxy<span class="op">$</span>x, myxy<span class="op">$</span>y)</span>
<span id="cb55-6"><a href="r-graphics-basics.html#cb55-6"></a><span class="kw">plot</span>(<span class="dt">x=</span>myxy<span class="op">$</span>x, <span class="dt">y=</span>myxy<span class="op">$</span>y)</span>
<span id="cb55-7"><a href="r-graphics-basics.html#cb55-7"></a><span class="kw">plot</span>(y<span class="op">~</span>x, <span class="dt">data=</span>myxy)</span>
<span id="cb55-8"><a href="r-graphics-basics.html#cb55-8"></a></span>
<span id="cb55-9"><a href="r-graphics-basics.html#cb55-9"></a>z &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dv">100</span>, <span class="dt">replace =</span>T)</span>
<span id="cb55-10"><a href="r-graphics-basics.html#cb55-10"></a><span class="kw">points</span>(x, z)</span>
<span id="cb55-11"><a href="r-graphics-basics.html#cb55-11"></a><span class="kw">points</span>(x, z, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
<div id="histogram" class="section level2">
<h2><span class="header-section-number">5.2</span> histogram</h2>
<p><code>hist</code> 함수는 데이터들의 분포를 히스토그램으로 그려주는 함수입니다. 히스토그램은 데이터들이 갖는 값을 특정 구간으로 나누고 각 구간에 해당하는 데이터가 몇 개인지 빈도수를 계산하여 막대그래프로 보여줍니다.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="r-graphics-basics.html#cb56-1"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb56-2"><a href="r-graphics-basics.html#cb56-2"></a><span class="kw">hist</span>(x, <span class="dt">br=</span><span class="dv">20</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">main=</span><span class="st">&quot;Main text&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;X label&quot;</span>)</span></code></pre></div>
</div>
<div id="boxplot" class="section level2">
<h2><span class="header-section-number">5.3</span> boxplot</h2>
<p>boxplot은 데이터의 여러가지 대표값 (중간값 median, 첫번째 사분위수 1st quantile, 세번째 사분위수 3rd quantile, 최소 minimum, 최대값 maximum) 등을 한눈에 볼 수 있도록 만들어놓은 그래프 입니다.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="r-graphics-basics.html#cb57-1"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb57-2"><a href="r-graphics-basics.html#cb57-2"></a><span class="kw">boxplot</span>(x)</span></code></pre></div>
<p>data.frame 타입의 오브젝트에 대해서 boxplot을 그릴 경우 여러 변수의 데이터들의 분포를 한눈에 비교할 수 있읍니다.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="r-graphics-basics.html#cb58-1"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb58-2"><a href="r-graphics-basics.html#cb58-2"></a><span class="co">#boxplot(y)</span></span>
<span id="cb58-3"><a href="r-graphics-basics.html#cb58-3"></a>xy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)</span>
<span id="cb58-4"><a href="r-graphics-basics.html#cb58-4"></a><span class="kw">boxplot</span>(xy)</span>
<span id="cb58-5"><a href="r-graphics-basics.html#cb58-5"></a><span class="kw">class</span>(xy)</span></code></pre></div>
</div>
<div id="barplot" class="section level2">
<h2><span class="header-section-number">5.4</span> barplot</h2>
<p>막대그래프는 기존 수업에서도 실습을 진행한 그래프로 각 값들을 막대 형태로 나란히 배치하여 서로 비교가 용이하도록 만든 그래프 입니다. <code>table</code> 함수는 같은 값을 갖는 데이터들이 몇 개나 있는지 테이블을 만들어주는 함수 입니다. rbind는 두 변수를 row를 기준으로 붙여주는 역할의 함수입니다.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="r-graphics-basics.html#cb59-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">200</span>, <span class="dt">replace =</span> T)</span>
<span id="cb59-2"><a href="r-graphics-basics.html#cb59-2"></a>tab_x &lt;-<span class="st"> </span><span class="kw">table</span>(x)</span>
<span id="cb59-3"><a href="r-graphics-basics.html#cb59-3"></a>y &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">200</span>, <span class="dt">replace =</span> T)</span>
<span id="cb59-4"><a href="r-graphics-basics.html#cb59-4"></a>tab_y &lt;-<span class="st"> </span><span class="kw">table</span>(y)</span>
<span id="cb59-5"><a href="r-graphics-basics.html#cb59-5"></a>tab_xy &lt;-<span class="st"> </span><span class="kw">rbind</span>(tab_x, tab_y)</span>
<span id="cb59-6"><a href="r-graphics-basics.html#cb59-6"></a><span class="co">#barplot(tab_xy)</span></span>
<span id="cb59-7"><a href="r-graphics-basics.html#cb59-7"></a><span class="co">#barplot(tab_xy, beside = T)</span></span>
<span id="cb59-8"><a href="r-graphics-basics.html#cb59-8"></a><span class="co">#barplot(tab_xy, beside = T, col=c(&quot;darkblue&quot;,&quot;red&quot;))</span></span>
<span id="cb59-9"><a href="r-graphics-basics.html#cb59-9"></a><span class="kw">barplot</span>(tab_xy, <span class="dt">beside =</span> T, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">xlab=</span><span class="st">&quot;Month&quot;</span>)</span>
<span id="cb59-10"><a href="r-graphics-basics.html#cb59-10"></a><span class="kw">barplot</span>(tab_xy, <span class="dt">beside =</span> T, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">xlab=</span><span class="st">&quot;Month&quot;</span>, <span class="dt">horiz=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div id="exercise-5-1" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Exercise 5-1</h3>
<ol style="list-style-type: decimal">
<li><code>iris</code> 데이터의 꽃받침 (Sepal) 길이와 넓이를 각각 x와 y축으로 하는 산포도를 그리시오</li>
<li><code>iris</code> 데이터에서 setosa 품종의 꽃받침의 길이와 넓이 데이터만 빨간 점으로 나타내시오</li>
<li><code>iris</code> 데이터에서 꽃받침과 꽃잎의 길이의 분포를 그리시오 (<code>hist</code> 사용)</li>
<li><code>iris</code> 데이터에서 꽃받침과 꽃잎의 넓이의 분포를 그리시오 (<code>boxplot</code> 사용)</li>
<li><code>iris</code> 데이터에서 품종별 꽃받침 길이의 분포를 그리시오 (<code>boxplot</code> 사용)</li>
</ol>
</div>
</div>
<div id="draw-multiple-graphs-in-the-same-plot" class="section level2">
<h2><span class="header-section-number">5.5</span> Draw multiple graphs in the same plot</h2>
<p>위 예제들에서 사용한 high level function들을 low level function (<code>lines</code>, <code>points</code>, <code>ablines</code>, <code>axis</code> 등)들과 함께 사용함으로써 원하는 도표 대부분을 그려낼 수 있습니다. 최근 널리 사용되는 <code>ggplot2</code> 패키지를 이용한 그래프 사용법 강의에서는 오늘 배우는 그래픽 명령어는 거의 사용하지 않습니다. 그러나 위 함수들은 R의 기본 그래프 함수들로서 단순한 도표에서부터 복잡한 그래픽까지 구현할 수 있는 다양한 유연성을 제공하므로 기본적인 사용법을 정확히 이해하는 것이 좋습니다.</p>
<p>아래 도표는 평균 0, 분산 1인 분포에서 500개의 랜덤한 수를 뽑아 x에 저장하고 x의 분포를 히스토그램으로 표현한 것 입니다. 그리고 x 값들과 상관성이 있는 y값들을 (x에 2를 곱하고 평균 5, 분산 1인 랜덤하게 뽑힌 수를 노이즈로 더함) 생성하고 모든 1000개 값들의 분포를 그린 히스토그램 입니다.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="r-graphics-basics.html#cb60-1"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>)</span>
<span id="cb60-2"><a href="r-graphics-basics.html#cb60-2"></a><span class="kw">hist</span>(x, <span class="dv">100</span>)</span>
<span id="cb60-3"><a href="r-graphics-basics.html#cb60-3"></a>y &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb60-4"><a href="r-graphics-basics.html#cb60-4"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb60-5"><a href="r-graphics-basics.html#cb60-5"></a><span class="kw">hist</span>(z, <span class="dt">br=</span><span class="dv">100</span>)</span></code></pre></div>
<p>이제 위 histogram 그래프에 <code>density</code> 함수와 <code>lines</code> 함수를 조합하여 확률밀도함수 커브를 그려 넣을 수 있습니다. 이 때 <code>hist</code> 함수에 <code>probability=T</code> 옵션을 넣어 y축의 스케일을 확률밀도함수의 y 스케일과 맞춰주어 같은 화면에 그려지도록 했습니다.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="r-graphics-basics.html#cb61-1"></a><span class="kw">hist</span>(z, <span class="dt">br=</span><span class="dv">100</span>)</span>
<span id="cb61-2"><a href="r-graphics-basics.html#cb61-2"></a><span class="kw">hist</span>(z, <span class="dt">br=</span><span class="dv">100</span>, <span class="dt">probability =</span> T)</span>
<span id="cb61-3"><a href="r-graphics-basics.html#cb61-3"></a>zd &lt;-<span class="st"> </span><span class="kw">density</span>(z)</span>
<span id="cb61-4"><a href="r-graphics-basics.html#cb61-4"></a><span class="kw">lines</span>(zd)</span></code></pre></div>
<p>또한 아래 그래프는 위에서 생성한 x, y 값의 산포도를 그리고 x축과 y축 범위를 xlim, ylim 파라메터로 조절하는 예제 입니다. ?pch 도움말을 참고하여 다양한 포인트 모양을 선택할 수 있으며 x 값이 0 보다 작은 경우의 index를 뽑아 해당되는 x 값들과 그 값들의 짝이 되는 y값들에 대해서만 다시 포인트 그림을 red 색상으로 그려 넣었습니다. lm 은 linear model의 약자로 회귀 곡선을 구할 때 사용하는 함수이며 이 함수를 abline과 조합하여 회귀 직선을 그릴 수 있습니다.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="r-graphics-basics.html#cb62-1"></a><span class="kw">plot</span>(x,y, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">15</span>), <span class="dt">pch=</span><span class="dv">3</span>)</span>
<span id="cb62-2"><a href="r-graphics-basics.html#cb62-2"></a>idx &lt;-<span class="st"> </span><span class="kw">which</span>(x<span class="op">&lt;</span><span class="dv">0</span>)</span>
<span id="cb62-3"><a href="r-graphics-basics.html#cb62-3"></a><span class="kw">points</span>(x[idx], y[idx], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb62-4"><a href="r-graphics-basics.html#cb62-4"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb62-5"><a href="r-graphics-basics.html#cb62-5"></a><span class="kw">abline</span>(fit)</span></code></pre></div>
<div id="exercise-5-2" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Exercise 5-2</h3>
<p><img src="images/05/01.png" /></p>
<ul>
<li>1부터 100까지 수 를 랜덤하게 1000개 생성해서 x좌표를 생성하고 xcoord에 저장 하시오 (중복허용)</li>
<li>1부터 100까지 수 를 랜덤하게 1000개 생성해서 y좌표를 생성하고 ycoord에 저장 하시오 (중복허용)</li>
<li>x, y 좌표 평면에 xcoord와 ycoord 값을 이용하여 좌표를 (산포도) 그리되 x와 y의 범위가 모두 -10부터 110까지 되도록 지정 하시오 (plot 이용)</li>
<li>앞서 문제와 같은 plot에 x가 50보다 크고 y가 50보다 큰 곳에 있는 좌표들에 red closed circle로 표현하시오 (which, points, pch parameter 등 이용, 아래 참고)</li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="r-graphics-basics.html#cb63-1"></a>idx &lt;-<span class="st"> </span><span class="kw">which</span>(xcoord<span class="op">&gt;</span><span class="dv">50</span> <span class="op">&amp;</span><span class="st"> </span>ycoord<span class="op">&gt;</span><span class="dv">50</span>)</span>
<span id="cb63-2"><a href="r-graphics-basics.html#cb63-2"></a><span class="kw">points</span>(<span class="dt">x=</span>xcoord[idx], <span class="dt">y=</span>ycoord[idx], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<ul>
<li>앞서 문제와 같은 plot에 x가 50보다 작고 y가 50보다 큰 곳에 있는 좌표들에 blue closed circle로 표현하시오 (which, points, pch parameter 등 이용)</li>
<li>앞서 문제와 같은 plot에 원점으로부터 거리가 50 이하인 좌표들을 green closed circle로 표현 하시오</li>
</ul>
</div>
</div>
<div id="barplot-for-multiplate-reader-data" class="section level2">
<h2><span class="header-section-number">5.6</span> Barplot for multiplate reader data</h2>
<p>이번에는 지난 4장에서 사용했던 엑셀 파일의 <a href="https://github.com/greendaygh/Rprog2020/blob/master/Exp_data.xls">Exp_data.xls</a> 데이터를 읽어 들여서 barplot을 그리는 또 다른 방법을 알아보겠습니다. 데이터 설명은 지난 4.10절을 참고하시면 되겠습니다. 우선 아래와 같이 데이터를 읽어들이고 필요한 변수들을 뽑아서 새로운 데이터프레임을 만듭니다.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="r-graphics-basics.html#cb64-1"></a><span class="kw">library</span>(readxl)</span>
<span id="cb64-2"><a href="r-graphics-basics.html#cb64-2"></a>mydata &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Exp_data.xls&quot;</span>, <span class="dt">sheet=</span><span class="dv">1</span>, <span class="dt">skip =</span> <span class="dv">0</span>, <span class="dt">col_names=</span>T)</span>
<span id="cb64-3"><a href="r-graphics-basics.html#cb64-3"></a>mydf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">well=</span>mydata<span class="op">$</span>Well, </span>
<span id="cb64-4"><a href="r-graphics-basics.html#cb64-4"></a>                   <span class="dt">od=</span>mydata<span class="op">$</span><span class="st">`</span><span class="dt">595nm_kk (A)</span><span class="st">`</span>, </span>
<span id="cb64-5"><a href="r-graphics-basics.html#cb64-5"></a>                   <span class="dt">gfp=</span>mydata<span class="op">$</span><span class="st">`</span><span class="dt">EGFP_sulim (Counts)</span><span class="st">`</span>)</span>
<span id="cb64-6"><a href="r-graphics-basics.html#cb64-6"></a><span class="kw">head</span>(mydf)</span></code></pre></div>
<p>데이터 설명은 4장을 다시 참고하시면 되겠습니다. 우리가 원하는 그림은 다음 배치의 샘플들에 대해서 농도별로 bar graph를 그리는 것 입니다. 그런데 위 <code>mydf</code> 데이터에는 아래 그림에서 보이는 샘플 이름이나 처리 약물의 농도와 같은 정보는 없습니다. 보통 이러한 정보는 실험을 계획할 단계에서 만들어 집니다. 따라서 본 강의에서는 이러한 정보도 엑셀 파일로 읽어 오는 것으로 합니다. <a href="https://github.com/greendaygh/Rprog2020/blob/master/Exp_design.xlsx">Exp_design.xlsx</a> 포멧은 <code>샘플이름</code>;<code>반복횟수</code>;<code>처리약물</code>;<code>농도</code> 입니다.</p>
<p><img src="images/05/02.PNG" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="r-graphics-basics.html#cb65-1"></a>designdata &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Exp_design.xlsx&quot;</span>, <span class="dt">sheet=</span><span class="dv">1</span>, </span>
<span id="cb65-2"><a href="r-graphics-basics.html#cb65-2"></a>                         <span class="dt">skip =</span> <span class="dv">0</span>, <span class="dt">col_names=</span>F)</span>
<span id="cb65-3"><a href="r-graphics-basics.html#cb65-3"></a>designdata</span></code></pre></div>
<p>우리가 할 일은 mydf 데이터의 각 샘플(row)에 맞는 이름, 반복횟수, 약물 농도 등을 붙여 넣는 것입니다. 각 well의 position은 row가 A~H까지 column은 1~12 이고 이 well들의 label이 위 <code>mydf</code>에 well이라는 변수로 저장되어 있습니다. 우선 위 designdata 의 값들을 일렬로 나열하고 각 well 이름을 붙여놓은 데이터프레임을 만들어 봅니다. 여기서 새로 사용된 함수는 <code>melt</code> 입니다. <code>reshape2</code> 패키지를 설치해야 합니다. 이 함수를 이용하면 (wide형) 데이터를 (long형) 데이터로 쉽게 변환할 수 있습니다.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="r-graphics-basics.html#cb66-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb66-2"><a href="r-graphics-basics.html#cb66-2"></a>labeldat &lt;-<span class="st"> </span><span class="kw">melt</span>(designdata, <span class="dt">measure.vars=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span>
<span id="cb66-3"><a href="r-graphics-basics.html#cb66-3"></a>labnum &lt;-<span class="st"> </span><span class="kw">formatC</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">each=</span><span class="dv">8</span>), <span class="dt">width=</span><span class="dv">2</span>, <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">flag=</span><span class="st">&quot;0&quot;</span>)</span>
<span id="cb66-4"><a href="r-graphics-basics.html#cb66-4"></a><span class="co">## add a new variable</span></span>
<span id="cb66-5"><a href="r-graphics-basics.html#cb66-5"></a>labeldat<span class="op">$</span>well &lt;-<span class="st"> </span><span class="kw">paste</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], labnum, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb66-6"><a href="r-graphics-basics.html#cb66-6"></a>labeldat</span></code></pre></div>
<p>그런데 위 ‘value’ 변수에 있는 값들은 문자열로서 <code>;</code> 기준으로 문자열을 나눠주어야 의미가 있습니다. 즉, 문자열 값들을 ‘이름’, ‘반복’, ‘약물’, ‘농도’ 순서로 분해해서 각각을 하나의 변수로 만들어야 합니다.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="r-graphics-basics.html#cb67-1"></a><span class="co">## remove &quot;-&quot;</span></span>
<span id="cb67-2"><a href="r-graphics-basics.html#cb67-2"></a>labeldat_sel &lt;-<span class="st"> </span>labeldat[labeldat<span class="op">$</span>value<span class="op">!=</span><span class="st">&quot;-&quot;</span>,]</span>
<span id="cb67-3"><a href="r-graphics-basics.html#cb67-3"></a><span class="co">## split</span></span>
<span id="cb67-4"><a href="r-graphics-basics.html#cb67-4"></a>labeldat_sel<span class="op">$</span>value[<span class="dv">2</span>]</span>
<span id="cb67-5"><a href="r-graphics-basics.html#cb67-5"></a><span class="kw">strsplit</span>(labeldat_sel<span class="op">$</span>value[<span class="dv">2</span>], <span class="dt">split=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb67-6"><a href="r-graphics-basics.html#cb67-6"></a>mylab_list &lt;-<span class="st"> </span><span class="kw">strsplit</span>(labeldat_sel<span class="op">$</span>value, <span class="dt">split=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb67-7"><a href="r-graphics-basics.html#cb67-7"></a><span class="co">## convert list to data.frame</span></span>
<span id="cb67-8"><a href="r-graphics-basics.html#cb67-8"></a><span class="co">## rbind(x[[1]], x[[2]], ...)</span></span>
<span id="cb67-9"><a href="r-graphics-basics.html#cb67-9"></a>mylab_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, mylab_list) </span>
<span id="cb67-10"><a href="r-graphics-basics.html#cb67-10"></a><span class="kw">head</span>(mylab_df)</span>
<span id="cb67-11"><a href="r-graphics-basics.html#cb67-11"></a><span class="kw">colnames</span>(mylab_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Chem&quot;</span>, <span class="st">&quot;Conc&quot;</span>)</span>
<span id="cb67-12"><a href="r-graphics-basics.html#cb67-12"></a><span class="co">## binding, selection</span></span>
<span id="cb67-13"><a href="r-graphics-basics.html#cb67-13"></a>mylab_df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">well =</span> labeldat_sel<span class="op">$</span>well, </span>
<span id="cb67-14"><a href="r-graphics-basics.html#cb67-14"></a>                        mylab_df, <span class="dt">stringsAsFactors =</span> F)</span>
<span id="cb67-15"><a href="r-graphics-basics.html#cb67-15"></a><span class="kw">str</span>(mylab_df2)</span></code></pre></div>
<p>이제 <code>mydf</code>와 <code>mylab_df2</code>를 합할 차례 입니다. <code>mydf</code>의 well 값과 <code>labeldat</code>의 well 값이 같은 것 끼리 묶이면 좋을 것 같습니다. 이런 경우 innerjoin 방법으로 <code>merge</code> 함수를 사용하면 됩니다.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="r-graphics-basics.html#cb68-1"></a><span class="co">## merge </span></span>
<span id="cb68-2"><a href="r-graphics-basics.html#cb68-2"></a>mydf2 &lt;-<span class="st"> </span><span class="kw">merge</span>(mydf, mylab_df2, <span class="dt">by=</span><span class="st">&#39;well&#39;</span>)</span></code></pre></div>
<p>이제 그래프를 그리기 위한 데이터가 준비 되었습니다. 지난 4장의 마지막 부분에서 그려 보았던 barplot을 그려 봅니다. A샘플의 평균과 표준편차를 이용한 막대그래프 입니다.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="r-graphics-basics.html#cb69-1"></a><span class="co">## subset</span></span>
<span id="cb69-2"><a href="r-graphics-basics.html#cb69-2"></a>mydf2_sub &lt;-<span class="st"> </span><span class="kw">subset</span>(mydf2, Name<span class="op">==</span><span class="st">&quot;A&quot;</span>)</span>
<span id="cb69-3"><a href="r-graphics-basics.html#cb69-3"></a><span class="co">## mean, sd for each group</span></span>
<span id="cb69-4"><a href="r-graphics-basics.html#cb69-4"></a>a_mean &lt;-<span class="st"> </span><span class="kw">aggregate</span>(mydf2_sub<span class="op">$</span>gfp, <span class="dt">by=</span><span class="kw">list</span>(mydf2_sub<span class="op">$</span>Conc), <span class="dt">FUN=</span>mean)</span>
<span id="cb69-5"><a href="r-graphics-basics.html#cb69-5"></a>a_sd &lt;-<span class="st">  </span><span class="kw">aggregate</span>(mydf2_sub<span class="op">$</span>gfp, <span class="dt">by=</span><span class="kw">list</span>(mydf2_sub<span class="op">$</span>Conc), <span class="dt">FUN=</span>sd)</span>
<span id="cb69-6"><a href="r-graphics-basics.html#cb69-6"></a>mydf2_merge &lt;-<span class="st"> </span><span class="kw">merge</span>(a_mean, a_sd, <span class="dt">by=</span><span class="st">&quot;Group.1&quot;</span>)</span>
<span id="cb69-7"><a href="r-graphics-basics.html#cb69-7"></a><span class="kw">colnames</span>(mydf2_merge) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Conc&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>)</span></code></pre></div>
<p>위와 같이 <code>subset</code>, <code>aggregate</code>, 그리고 <code>merge</code> 함수를 이용해서 원하는 데이터를 손쉽게 추출할 수 있고 아래와 같은 막대 그래프를 그릴 수 있습니다. 4장에서 수행한 코드들과 비교해 보면 간결하고 직관적으로 바뀐 것을 알 수 있습니다.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="r-graphics-basics.html#cb70-1"></a><span class="kw">barplot</span>(mydf2_merge<span class="op">$</span>mean, </span>
<span id="cb70-2"><a href="r-graphics-basics.html#cb70-2"></a>        <span class="dt">names.arg=</span>mydf2_merge<span class="op">$</span>Conc, </span>
<span id="cb70-3"><a href="r-graphics-basics.html#cb70-3"></a>        <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">80000</span>))</span></code></pre></div>
<p><img src="images/05/03.png" /></p>
<p>그런데 샘플 A 뿐만 아니라 모든 샘플에 대해서 한 눈에 들어오는 그래프를 그릴 필요가 있습니다. 본격적인 그래프 실습은 <code>ggplot2</code> 패키지를 이용해서 진행하기로 하고 지금은 우선 <code>barplot</code> 함수를 이용해서 간단하게 평균을 모두 그려보는 실습을 하겠습니다.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="r-graphics-basics.html#cb71-1"></a>mydf_mean &lt;-<span class="st"> </span><span class="kw">aggregate</span>(mydf2<span class="op">$</span>gfp, </span>
<span id="cb71-2"><a href="r-graphics-basics.html#cb71-2"></a>                       <span class="dt">by=</span><span class="kw">list</span>(mydf2<span class="op">$</span>Name, mydf2<span class="op">$</span>Conc), </span>
<span id="cb71-3"><a href="r-graphics-basics.html#cb71-3"></a>                       <span class="dt">FUN=</span>mean)</span>
<span id="cb71-4"><a href="r-graphics-basics.html#cb71-4"></a><span class="kw">colnames</span>(mydf_mean) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Conc&quot;</span>, <span class="st">&quot;mean&quot;</span>)</span>
<span id="cb71-5"><a href="r-graphics-basics.html#cb71-5"></a>mydf_mean</span></code></pre></div>
<p>위와 같이 <code>aggregate</code> 함수를 사용해서 Name과 Conc를 기준으로 모든 데이터에 대한 평균을 구할 수 있습니다. 그런데 위 데이터는 long형 데이터로서 ggplot에서 사용되는 데이터 형식이고 barplot을 사용하기 위해서는 wide형 데이터로 변환해 줄 필요가 있습니다.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="r-graphics-basics.html#cb72-1"></a>tmpdf &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydf_mean[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="st">&quot;mean&quot;</span>], </span>
<span id="cb72-2"><a href="r-graphics-basics.html#cb72-2"></a>               mydf_mean[<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>,<span class="st">&quot;mean&quot;</span>], </span>
<span id="cb72-3"><a href="r-graphics-basics.html#cb72-3"></a>               mydf_mean[<span class="dv">13</span><span class="op">:</span><span class="dv">18</span>,<span class="st">&quot;mean&quot;</span>],</span>
<span id="cb72-4"><a href="r-graphics-basics.html#cb72-4"></a>               mydf_mean[<span class="dv">19</span><span class="op">:</span><span class="dv">24</span>,<span class="st">&quot;mean&quot;</span>],</span>
<span id="cb72-5"><a href="r-graphics-basics.html#cb72-5"></a>               mydf_mean[<span class="dv">25</span><span class="op">:</span><span class="dv">30</span>,<span class="st">&quot;mean&quot;</span>],</span>
<span id="cb72-6"><a href="r-graphics-basics.html#cb72-6"></a>               mydf_mean[<span class="dv">31</span><span class="op">:</span><span class="dv">36</span>,<span class="st">&quot;mean&quot;</span>]</span>
<span id="cb72-7"><a href="r-graphics-basics.html#cb72-7"></a>               )</span>
<span id="cb72-8"><a href="r-graphics-basics.html#cb72-8"></a><span class="kw">colnames</span>(tmpdf) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>)</span>
<span id="cb72-9"><a href="r-graphics-basics.html#cb72-9"></a><span class="kw">rownames</span>(tmpdf) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;0.1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;100&quot;</span>, <span class="st">&quot;1000&quot;</span>)</span>
<span id="cb72-10"><a href="r-graphics-basics.html#cb72-10"></a>tmpdf</span></code></pre></div>
<p>위와 같은 wide형 데이터에 대해서 barplot 함수를 사용 할 경우 아래와 같이 두 개의 그룹을 갖는 데이터를 비교할 수 있는 막대그래프를 그릴 수 있습니다.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="r-graphics-basics.html#cb73-1"></a><span class="kw">barplot</span>(tmpdf, <span class="dt">beside =</span> T)</span></code></pre></div>
<p><img src="images/05/04.png" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="r-graphics-basics.html#cb74-1"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb74-2"><a href="r-graphics-basics.html#cb74-2"></a><span class="kw">display.brewer.all</span>()</span>
<span id="cb74-3"><a href="r-graphics-basics.html#cb74-3"></a>mycol &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">6</span>, <span class="st">&quot;RdBu&quot;</span>)</span>
<span id="cb74-4"><a href="r-graphics-basics.html#cb74-4"></a><span class="kw">barplot</span>(tmpdf, <span class="dt">beside =</span> T, <span class="dt">col=</span>mycol)</span>
<span id="cb74-5"><a href="r-graphics-basics.html#cb74-5"></a><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, </span>
<span id="cb74-6"><a href="r-graphics-basics.html#cb74-6"></a>       <span class="dt">title =</span> <span class="st">&#39;Conc&#39;</span>, </span>
<span id="cb74-7"><a href="r-graphics-basics.html#cb74-7"></a>       <span class="dt">legend =</span> <span class="kw">rownames</span>(tmpdf), </span>
<span id="cb74-8"><a href="r-graphics-basics.html#cb74-8"></a>       <span class="dt">fill=</span>mycol, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>) </span></code></pre></div>
<p><img src="images/05/05.png" /></p>
<hr />
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="크리에이티브 커먼즈 라이선스" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />이 저작물은 <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">크리에이티브 커먼즈 저작자표시-비영리-변경금지 4.0 국제 라이선스</a>에 따라 이용할 수 있습니다.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-programming-basics-ii.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-graphics-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
