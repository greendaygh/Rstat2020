<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Confidence intervals | R로 배우는 기초통계</title>
  <meta name="description" content="UST lecture web site" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Confidence intervals | R로 배우는 기초통계" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="UST lecture web site" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Confidence intervals | R로 배우는 기초통계" />
  
  <meta name="twitter:description" content="UST lecture web site" />
  

<meta name="author" content="한국생명공학연구원 김하성" />


<meta name="date" content="2020-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-inference.html"/>
<link rel="next" href="significance-test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> Introduction to statistics with R </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction 강의 개요</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#goal-강의-목표"><i class="fa fa-check"></i><b>1.1</b> Goal 강의 목표</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#this-course"><i class="fa fa-check"></i><b>1.2</b> This course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#tips"><i class="fa fa-check"></i><b>1.3</b> Tips</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#references-books-참고-교제"><i class="fa fa-check"></i><b>1.4</b> References books 참고 교제</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references-참고-자료"><i class="fa fa-check"></i><b>1.5</b> References 참고 자료</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#evaluation-평가-세부-항목"><i class="fa fa-check"></i><b>1.6</b> Evaluation 평가 세부 항목</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#schedule-강의-계획"><i class="fa fa-check"></i><b>1.7</b> Schedule 강의 계획</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#r-lecture-youtube-link"><i class="fa fa-check"></i><b>1.8</b> R Lecture Youtube Link</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#lecture-chapter-1"><i class="fa fa-check"></i><b>1.8.1</b> Lecture Chapter 1</a></li>
<li class="chapter" data-level="1.8.2" data-path="index.html"><a href="index.html#lecture-2"><i class="fa fa-check"></i><b>1.8.2</b> Lecture 2</a></li>
<li class="chapter" data-level="1.8.3" data-path="index.html"><a href="index.html#lecture-3"><i class="fa fa-check"></i><b>1.8.3</b> Lecture 3</a></li>
<li class="chapter" data-level="1.8.4" data-path="index.html"><a href="index.html#lecture-4"><i class="fa fa-check"></i><b>1.8.4</b> Lecture 4</a></li>
<li class="chapter" data-level="1.8.5" data-path="index.html"><a href="index.html#lecture-5"><i class="fa fa-check"></i><b>1.8.5</b> Lecture 5</a></li>
<li class="chapter" data-level="1.8.6" data-path="index.html"><a href="index.html#lecture-6"><i class="fa fa-check"></i><b>1.8.6</b> Lecture 6</a></li>
<li class="chapter" data-level="1.8.7" data-path="index.html"><a href="index.html#lecture-7"><i class="fa fa-check"></i><b>1.8.7</b> Lecture 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> R basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-basics.html"><a href="r-basics.html#what-is-r-rstudio"><i class="fa fa-check"></i><b>2.1</b> What is R / Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="r-basics.html"><a href="r-basics.html#r-rstudio-installation"><i class="fa fa-check"></i><b>2.2</b> R / Rstudio installation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="r-basics.html"><a href="r-basics.html#r-설치"><i class="fa fa-check"></i><b>2.2.1</b> R 설치</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-basics.html"><a href="r-basics.html#rstudio-설치"><i class="fa fa-check"></i><b>2.2.2</b> Rstudio 설치</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html#rstudio-interface"><i class="fa fa-check"></i><b>2.3</b> Rstudio interface</a></li>
<li class="chapter" data-level="2.4" data-path="r-basics.html"><a href="r-basics.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4</b> Keyboard shortcuts</a></li>
<li class="chapter" data-level="2.5" data-path="r-basics.html"><a href="r-basics.html#r-programming-basics-and-terminology"><i class="fa fa-check"></i><b>2.5</b> R programming basics and terminology</a></li>
<li class="chapter" data-level="2.6" data-path="r-basics.html"><a href="r-basics.html#set-a-working-directory"><i class="fa fa-check"></i><b>2.6</b> Set a working directory</a></li>
<li class="chapter" data-level="2.7" data-path="r-basics.html"><a href="r-basics.html#r-coding-practice"><i class="fa fa-check"></i><b>2.7</b> R coding practice</a></li>
<li class="chapter" data-level="2.8" data-path="r-basics.html"><a href="r-basics.html#variables-and-values"><i class="fa fa-check"></i><b>2.8</b> Variables and values</a></li>
<li class="chapter" data-level="2.9" data-path="r-basics.html"><a href="r-basics.html#variable-type-of-storage-mode"><i class="fa fa-check"></i><b>2.9</b> Variable type of (storage) mode</a></li>
<li class="chapter" data-level="2.10" data-path="r-basics.html"><a href="r-basics.html#variable---vectors"><i class="fa fa-check"></i><b>2.10</b> Variable - Vectors</a></li>
<li class="chapter" data-level="2.11" data-path="r-basics.html"><a href="r-basics.html#functions"><i class="fa fa-check"></i><b>2.11</b> Functions</a></li>
<li class="chapter" data-level="2.12" data-path="r-basics.html"><a href="r-basics.html#vectorized-functions"><i class="fa fa-check"></i><b>2.12</b> Vectorized functions</a></li>
<li class="chapter" data-level="2.13" data-path="r-basics.html"><a href="r-basics.html#help"><i class="fa fa-check"></i><b>2.13</b> Help</a></li>
<li class="chapter" data-level="2.14" data-path="r-basics.html"><a href="r-basics.html#r-packages"><i class="fa fa-check"></i><b>2.14</b> R packages</a></li>
<li class="chapter" data-level="2.15" data-path="r-basics.html"><a href="r-basics.html#data-sets"><i class="fa fa-check"></i><b>2.15</b> Data sets</a></li>
<li class="chapter" data-level="2.16" data-path="r-basics.html"><a href="r-basics.html#cheatsheet"><i class="fa fa-check"></i><b>2.16</b> Cheatsheet</a></li>
<li class="chapter" data-level="2.17" data-path="r-basics.html"><a href="r-basics.html#problems"><i class="fa fa-check"></i><b>2.17</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="univariat-data.html"><a href="univariat-data.html"><i class="fa fa-check"></i><b>3</b> Univariat data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="univariat-data.html"><a href="univariat-data.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction 2</a></li>
<li class="chapter" data-level="3.2" data-path="univariat-data.html"><a href="univariat-data.html#data-vectors"><i class="fa fa-check"></i><b>3.2</b> Data vectors</a></li>
<li class="chapter" data-level="3.3" data-path="univariat-data.html"><a href="univariat-data.html#data-type"><i class="fa fa-check"></i><b>3.3</b> Data type</a></li>
<li class="chapter" data-level="3.4" data-path="univariat-data.html"><a href="univariat-data.html#functions-2"><i class="fa fa-check"></i><b>3.4</b> Functions 2</a></li>
<li class="chapter" data-level="3.5" data-path="univariat-data.html"><a href="univariat-data.html#miscellaneous-1"><i class="fa fa-check"></i><b>3.5</b> Miscellaneous 1</a></li>
<li class="chapter" data-level="3.6" data-path="univariat-data.html"><a href="univariat-data.html#numeric-summaries"><i class="fa fa-check"></i><b>3.6</b> Numeric summaries</a></li>
<li class="chapter" data-level="3.7" data-path="univariat-data.html"><a href="univariat-data.html#center-for-a-univariat-variable"><i class="fa fa-check"></i><b>3.7</b> Center for a univariat variable</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="univariat-data.html"><a href="univariat-data.html#sample-mean"><i class="fa fa-check"></i><b>3.7.1</b> Sample mean</a></li>
<li class="chapter" data-level="3.7.2" data-path="univariat-data.html"><a href="univariat-data.html#measure-of-position"><i class="fa fa-check"></i><b>3.7.2</b> Measure of Position</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="univariat-data.html"><a href="univariat-data.html#spread-for-a-univariat-variable"><i class="fa fa-check"></i><b>3.8</b> Spread for a univariat variable</a></li>
<li class="chapter" data-level="3.9" data-path="univariat-data.html"><a href="univariat-data.html#problems-02"><i class="fa fa-check"></i><b>3.9</b> Problems 02</a></li>
<li class="chapter" data-level="3.10" data-path="univariat-data.html"><a href="univariat-data.html#shape-for-a-univariat-variable"><i class="fa fa-check"></i><b>3.10</b> Shape for a univariat variable</a></li>
<li class="chapter" data-level="3.11" data-path="univariat-data.html"><a href="univariat-data.html#viewing-the-shape"><i class="fa fa-check"></i><b>3.11</b> Viewing the shape</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="univariat-data.html"><a href="univariat-data.html#histogram"><i class="fa fa-check"></i><b>3.11.1</b> Histogram</a></li>
<li class="chapter" data-level="3.11.2" data-path="univariat-data.html"><a href="univariat-data.html#density-plots"><i class="fa fa-check"></i><b>3.11.2</b> Density plots</a></li>
<li class="chapter" data-level="3.11.3" data-path="univariat-data.html"><a href="univariat-data.html#boxplots"><i class="fa fa-check"></i><b>3.11.3</b> Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="univariat-data.html"><a href="univariat-data.html#quantile-graph"><i class="fa fa-check"></i><b>3.12</b> Quantile graph</a></li>
<li class="chapter" data-level="3.13" data-path="univariat-data.html"><a href="univariat-data.html#categorical-data"><i class="fa fa-check"></i><b>3.13</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bivariate-data.html"><a href="bivariate-data.html"><i class="fa fa-check"></i><b>4</b> Bivariate data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="bivariate-data.html"><a href="bivariate-data.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction 3</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="bivariate-data.html"><a href="bivariate-data.html#independence-samples"><i class="fa fa-check"></i><b>4.1.1</b> Independence samples</a></li>
<li class="chapter" data-level="4.1.2" data-path="bivariate-data.html"><a href="bivariate-data.html#plot"><i class="fa fa-check"></i><b>4.1.2</b> plot</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bivariate-data.html"><a href="bivariate-data.html#data-manipulation"><i class="fa fa-check"></i><b>4.2</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="bivariate-data.html"><a href="bivariate-data.html#list"><i class="fa fa-check"></i><b>4.2.1</b> List</a></li>
<li class="chapter" data-level="4.2.2" data-path="bivariate-data.html"><a href="bivariate-data.html#data-frame"><i class="fa fa-check"></i><b>4.2.2</b> Data frame</a></li>
<li class="chapter" data-level="4.2.3" data-path="bivariate-data.html"><a href="bivariate-data.html#model-formulas"><i class="fa fa-check"></i><b>4.2.3</b> Model formulas</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="bivariate-data.html"><a href="bivariate-data.html#paired-data"><i class="fa fa-check"></i><b>4.3</b> Paired data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="bivariate-data.html"><a href="bivariate-data.html#pearson-correlation"><i class="fa fa-check"></i><b>4.3.1</b> Pearson Correlation</a></li>
<li class="chapter" data-level="4.3.2" data-path="bivariate-data.html"><a href="bivariate-data.html#spearman-correlation-coefficient"><i class="fa fa-check"></i><b>4.3.2</b> Spearman correlation coefficient</a></li>
<li class="chapter" data-level="4.3.3" data-path="bivariate-data.html"><a href="bivariate-data.html#correlation-causation-and-association"><i class="fa fa-check"></i><b>4.3.3</b> Correlation, causation and association</a></li>
<li class="chapter" data-level="4.3.4" data-path="bivariate-data.html"><a href="bivariate-data.html#trends"><i class="fa fa-check"></i><b>4.3.4</b> Trends</a></li>
<li class="chapter" data-level="4.3.5" data-path="bivariate-data.html"><a href="bivariate-data.html#the-method-of-least-squares"><i class="fa fa-check"></i><b>4.3.5</b> The method of least squares</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bivariate-data.html"><a href="bivariate-data.html#problems-03"><i class="fa fa-check"></i><b>4.4</b> Problems 03</a></li>
<li class="chapter" data-level="4.5" data-path="bivariate-data.html"><a href="bivariate-data.html#bivariate-categorical-data"><i class="fa fa-check"></i><b>4.5</b> Bivariate categorical data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="bivariate-data.html"><a href="bivariate-data.html#contingency-tables"><i class="fa fa-check"></i><b>4.5.1</b> Contingency tables</a></li>
<li class="chapter" data-level="4.5.2" data-path="bivariate-data.html"><a href="bivariate-data.html#marginal-distributions"><i class="fa fa-check"></i><b>4.5.2</b> Marginal distributions</a></li>
<li class="chapter" data-level="4.5.3" data-path="bivariate-data.html"><a href="bivariate-data.html#conditional-distributions"><i class="fa fa-check"></i><b>4.5.3</b> Conditional distributions</a></li>
<li class="chapter" data-level="4.5.4" data-path="bivariate-data.html"><a href="bivariate-data.html#graphical-summaries-of-contingency-tables"><i class="fa fa-check"></i><b>4.5.4</b> Graphical summaries of contingency tables</a></li>
<li class="chapter" data-level="4.5.5" data-path="bivariate-data.html"><a href="bivariate-data.html#measures-of-association-for-categorical-data"><i class="fa fa-check"></i><b>4.5.5</b> Measures of association for categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="bivariate-data.html"><a href="bivariate-data.html#problems-04"><i class="fa fa-check"></i><b>4.6</b> Problems 04</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html"><i class="fa fa-check"></i><b>5</b> Data transformation basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#data-structures-in-r"><i class="fa fa-check"></i><b>5.1</b> Data structures in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#vectors"><i class="fa fa-check"></i><b>5.1.1</b> Vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#lists"><i class="fa fa-check"></i><b>5.1.2</b> Lists</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#matrices"><i class="fa fa-check"></i><b>5.1.3</b> Matrices</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#data.frame"><i class="fa fa-check"></i><b>5.1.4</b> data.frame</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#subset"><i class="fa fa-check"></i><b>5.2</b> subset</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#merging-and-split"><i class="fa fa-check"></i><b>5.3</b> merging and split</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#transforming-data"><i class="fa fa-check"></i><b>5.4</b> transforming data</a></li>
<li class="chapter" data-level="5.5" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#analysis-example-babies"><i class="fa fa-check"></i><b>5.5</b> Analysis example (babies)</a></li>
<li class="chapter" data-level="5.6" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#apply"><i class="fa fa-check"></i><b>5.6</b> apply</a></li>
<li class="chapter" data-level="5.7" data-path="data-transformation-basics.html"><a href="data-transformation-basics.html#problems-05"><i class="fa fa-check"></i><b>5.7</b> Problems 05</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html"><i class="fa fa-check"></i><b>6</b> Multivariate (tydiverse)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#tidy-data-structure"><i class="fa fa-check"></i><b>6.1</b> Tidy data structure</a></li>
<li class="chapter" data-level="6.2" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#data-manipulation-with-dplyr"><i class="fa fa-check"></i><b>6.2</b> Data manipulation with dplyr</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#dplyr---pipe-operator"><i class="fa fa-check"></i><b>6.2.1</b> dplyr - pipe operator</a></li>
<li class="chapter" data-level="6.2.2" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#dplyr---important-functions"><i class="fa fa-check"></i><b>6.2.2</b> dplyr - Important functions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#code-comparison"><i class="fa fa-check"></i><b>6.3</b> code comparison</a></li>
<li class="chapter" data-level="6.4" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#dplyr-example-iris"><i class="fa fa-check"></i><b>6.4</b> dplyr example iris</a></li>
<li class="chapter" data-level="6.5" data-path="multivariate-tydiverse.html"><a href="multivariate-tydiverse.html#problems-06"><i class="fa fa-check"></i><b>6.5</b> Problems 06</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="populations.html"><a href="populations.html"><i class="fa fa-check"></i><b>7</b> Populations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="populations.html"><a href="populations.html#random-variable"><i class="fa fa-check"></i><b>7.1</b> Random variable</a></li>
<li class="chapter" data-level="7.2" data-path="populations.html"><a href="populations.html#discrete-random-variable"><i class="fa fa-check"></i><b>7.2</b> Discrete random variable</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="populations.html"><a href="populations.html#probability-mass-function"><i class="fa fa-check"></i><b>7.2.1</b> Probability mass function</a></li>
<li class="chapter" data-level="7.2.2" data-path="populations.html"><a href="populations.html#mean-and-standard-deviation-of-discrete-r.v."><i class="fa fa-check"></i><b>7.2.2</b> Mean and standard deviation of discrete R.V.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="populations.html"><a href="populations.html#continuous-random-variable"><i class="fa fa-check"></i><b>7.3</b> Continuous random variable</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="populations.html"><a href="populations.html#probability-density-function"><i class="fa fa-check"></i><b>7.3.1</b> Probability density function</a></li>
<li class="chapter" data-level="7.3.2" data-path="populations.html"><a href="populations.html#mean-and-standard-deviation-of-continuous-r.v."><i class="fa fa-check"></i><b>7.3.2</b> Mean and standard deviation of continuous R.V.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="populations.html"><a href="populations.html#sampling-from-a-population"><i class="fa fa-check"></i><b>7.4</b> Sampling from a population</a></li>
<li class="chapter" data-level="7.5" data-path="populations.html"><a href="populations.html#problems-07"><i class="fa fa-check"></i><b>7.5</b> Problems 07</a></li>
<li class="chapter" data-level="7.6" data-path="populations.html"><a href="populations.html#sampling-distribution"><i class="fa fa-check"></i><b>7.6</b> Sampling distribution</a></li>
<li class="chapter" data-level="7.7" data-path="populations.html"><a href="populations.html#probability-distributions"><i class="fa fa-check"></i><b>7.7</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="populations.html"><a href="populations.html#bernoulli-random-variables"><i class="fa fa-check"></i><b>7.7.1</b> Bernoulli random variables</a></li>
<li class="chapter" data-level="7.7.2" data-path="populations.html"><a href="populations.html#binomial-random-variables"><i class="fa fa-check"></i><b>7.7.2</b> Binomial random variables</a></li>
<li class="chapter" data-level="7.7.3" data-path="populations.html"><a href="populations.html#normal-random-variables"><i class="fa fa-check"></i><b>7.7.3</b> Normal random variables</a></li>
<li class="chapter" data-level="7.7.4" data-path="populations.html"><a href="populations.html#uniform-distribution"><i class="fa fa-check"></i><b>7.7.4</b> Uniform distribution</a></li>
<li class="chapter" data-level="7.7.5" data-path="populations.html"><a href="populations.html#poisson-distribution"><i class="fa fa-check"></i><b>7.7.5</b> Poisson distribution</a></li>
<li class="chapter" data-level="7.7.6" data-path="populations.html"><a href="populations.html#exponential-distribution"><i class="fa fa-check"></i><b>7.7.6</b> Exponential distribution</a></li>
<li class="chapter" data-level="7.7.7" data-path="populations.html"><a href="populations.html#sampling-distributions"><i class="fa fa-check"></i><b>7.7.7</b> Sampling distributions</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="populations.html"><a href="populations.html#problems-07-2"><i class="fa fa-check"></i><b>7.8</b> Problems 07-2</a></li>
<li class="chapter" data-level="7.9" data-path="populations.html"><a href="populations.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>7.9</b> The central limit theorem</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>8</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="statistical-inference.html"><a href="statistical-inference.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="statistical-inference.html"><a href="statistical-inference.html#simulation"><i class="fa fa-check"></i><b>8.2</b> Simulation</a></li>
<li class="chapter" data-level="8.3" data-path="statistical-inference.html"><a href="statistical-inference.html#z-statistics-with-simulation"><i class="fa fa-check"></i><b>8.3</b> z-statistics with simulation</a></li>
<li class="chapter" data-level="8.4" data-path="statistical-inference.html"><a href="statistical-inference.html#t-statistics"><i class="fa fa-check"></i><b>8.4</b> t-statistics</a></li>
<li class="chapter" data-level="8.5" data-path="statistical-inference.html"><a href="statistical-inference.html#two-sample-significance-tests"><i class="fa fa-check"></i><b>8.5</b> Two sample significance tests</a></li>
<li class="chapter" data-level="8.6" data-path="statistical-inference.html"><a href="statistical-inference.html#estimation-and-confidence-interval"><i class="fa fa-check"></i><b>8.6</b> Estimation and confidence interval</a></li>
<li class="chapter" data-level="8.7" data-path="statistical-inference.html"><a href="statistical-inference.html#bootstrap"><i class="fa fa-check"></i><b>8.7</b> Bootstrap</a></li>
<li class="chapter" data-level="8.8" data-path="statistical-inference.html"><a href="statistical-inference.html#problem-08"><i class="fa fa-check"></i><b>8.8</b> Problem 08</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#ci-for-population-proportion-p"><i class="fa fa-check"></i><b>9.1</b> CI for population proportion, <span class="math inline">\(p\)</span></a></li>
<li class="chapter" data-level="9.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#ci-for-population-mean"><i class="fa fa-check"></i><b>9.2</b> CI for population mean</a></li>
<li class="chapter" data-level="9.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#ci-for-the-differences"><i class="fa fa-check"></i><b>9.3</b> CI for the differences</a></li>
<li class="chapter" data-level="9.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#problem-09"><i class="fa fa-check"></i><b>9.4</b> Problem 09</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="significance-test.html"><a href="significance-test.html"><i class="fa fa-check"></i><b>10</b> Significance test</a>
<ul>
<li class="chapter" data-level="10.1" data-path="significance-test.html"><a href="significance-test.html#errors-in-significance-tests"><i class="fa fa-check"></i><b>10.1</b> Errors in significance tests</a></li>
<li class="chapter" data-level="10.2" data-path="significance-test.html"><a href="significance-test.html#significance-test-for-a-population-proportion"><i class="fa fa-check"></i><b>10.2</b> Significance test for a population proportion</a></li>
<li class="chapter" data-level="10.3" data-path="significance-test.html"><a href="significance-test.html#significance-test-for-the-mean-t-test"><i class="fa fa-check"></i><b>10.3</b> Significance test for the mean (t-test)</a></li>
<li class="chapter" data-level="10.4" data-path="significance-test.html"><a href="significance-test.html#problem-10"><i class="fa fa-check"></i><b>10.4</b> Problem 10</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R로 배우는 기초통계</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="confidence-intervals" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Confidence intervals</h1>
<p><a href="https://youtu.be/Xv7RZncGDwE" class="uri">https://youtu.be/Xv7RZncGDwE</a></p>
<p><img src="images/09/statistical_inference.png" /></p>
<p>점추정의 경우 이항분포에서 모비율을 추정하는 추정량인 (estimator) <span class="math inline">\(np\)</span>나 정규분포의 표본평균의 추정량인 <span class="math inline">\(\bar{X} = \sum_{i=1}^n X_i/n\)</span> 등이 점추정량이고 이들은 모두 추정량의 특징인 불편성을 만족하는 불편추정량 (unbiased estimator)입니다. 불편추정량이란 점추정량 <span class="math inline">\(\hat{\theta}\)</span>의 기대치 <span class="math inline">\(E(\hat{\theta})\)</span>이 모집단의 모수 <span class="math inline">\(\theta\)</span>와 같은 추정량을 말하며 앞서 중심극한 정리에 의해서 표본평균의 기대값이 모평균과 같음을 배웠으므로 <span class="math inline">\(\bar{X}\)</span>가 불편추정량이 되는 것 입니다.</p>
<p>그런데 점추정량은 표본에 따라서 다르고 오차에 대한 정보도 제공하지 못하므로 점추정량에 오차한계를 빼고 더해서 추정량의 하한치와 상한치를 구하여 모수를 포함하는 구간을 나타내는 신뢰구간을 사용합니다. 신뢰구간은 모수를 포함할 범위를 말하며 다음과 같이 정의할 수 있습니다.</p>
<p><span class="math inline">\(p( \hat{\theta_L} \le \theta \le \hat{\theta_U} ) = 1-\alpha\)</span></p>
<p>여기서 1-<span class="math inline">\(\alpha\)</span>를 백분률로 치환한 값 <span class="math inline">\((1-\alpha)\cdot 100%\)</span>를 신뢰수준이라고 합니다. 여기서 <span class="math inline">\(\alpha\)</span>는 유의수준 (significance level)이며 신뢰구간 <span class="math inline">\([\hat{\theta_L}, \hat{\theta_U}]\)</span>에 모수 <span class="math inline">\(\theta\)</span>가 포함되지 않을 확률이라고 할 수 있습니다. 일반적으로 신뢰수준 90%, 95%, 99%에 상응하는 유의수준 <span class="math inline">\(\alpha\)</span>=0.1, 0.05, 0.01 이 사용됩니다. 95% 신뢰구간을 해석할 때 해당 구간에 모수를 포함할 확률이 95% 이다라고 해석할 수 있습니다. 틀린 해석이라고 할 수는 없지만 더 정확한 해석은 표본 추출을 100번 반복해서 100개의 신뢰구간을 구했을 때 그 중 95개의 신뢰구간이 모평균을 포함하는 구간이다 라고 해석하는 것입니다.</p>
<div id="ci-for-population-proportion-p" class="section level2">
<h2><span class="header-section-number">9.1</span> CI for population proportion, <span class="math inline">\(p\)</span></h2>
<p>앞서 장에서는 시뮬레이션에 기반한 신뢰구간을 알아보았습니다. 아래는 분포 가정에 기반한 모비율 <span class="math inline">\(p\)</span>에 대한 신뢰구간을 구하는 방법입니다. <span class="math inline">\(X\)</span>를 이항분포를 따르는 성공의 갯수라고 정의하면 <span class="math inline">\(X\)</span>~B(n, p) 입니다. 여기서 <span class="math inline">\(n\)</span>은 시행횟수이고 <span class="math inline">\(p\)</span>는 성공 비율입니다. 그런데 <span class="math inline">\(n\)</span>이 충분히 클 경우 <span class="math inline">\(X \sim N(np, npq)\)</span> 임이 알려져 있습니다. <span class="math inline">\(\hat{p}\)</span>은 성공의 갯수를 나타내는 확률변수 <span class="math inline">\(X\)</span>를 <span class="math inline">\(n\)</span>으로 나누어 준 값으로 볼 수 있고 이는 다음과 같은 분포로 정의될 수 있습니다.</p>
<p><span class="math display">\[
\frac{X}{n} \sim N(\frac{np}{n}, \frac{\sqrt{npq}}{n}) \\
\hat{p} \sim N(p, \sqrt{\frac{p(1-p)}{n}}) 
\]</span></p>
<p><span class="math display">\[
SD(\hat{p}) = \sqrt{\frac{p(1-p)}{n}}
\]</span></p>
<p>이라 하면 충분히 큰 <span class="math inline">\(n\)</span>에 대해서 다음 값은 표준정규분포를 따릅니다.</p>
<p><span class="math display">\[
Z = \frac{\hat{p} - p}{SD(\hat{p})}
\]</span></p>
<p>표준정규분포에서 0.95 확률에 해당하는 구간을 구하면 다음과 같습니다.</p>
<p><span class="math display">\[
-1.96 &lt; \frac{\hat{p} - p}{SD(\hat{p})} &lt; 1.96 
\]</span></p>
<p>위 식을 모수 <span class="math inline">\(p\)</span>를 기준으로 변형하면 다음과 같습니다.</p>
<p><span class="math display">\[
\hat{p} - 1.96 \cdot SD(\hat{p}) &lt;  p &lt; \hat{p} + 1.96 \cdot SD(\hat{p})
\]</span></p>
<p>위 범위가 모수 <span class="math inline">\(p\)</span>에 대한 신뢰구간입니다. 그러나 <span class="math inline">\(SD(\hat{p}) = \sqrt{\frac{p(1-p)}{n}}\)</span>에서 <span class="math inline">\(p\)</span>는 일반적으로 알 수 없으므로 샘플로부터 계산된 <span class="math inline">\(\hat{p}\)</span>를 이용한 표준오차 (Standard error)를 사용합니다.</p>
<p><span class="math display">\[
SE(\hat{p}) = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}
\]</span></p>
<p><span class="math inline">\(SE(\hat{p})\)</span> 를 사용한 다음 통계량의 경우도 충분히 큰 <span class="math inline">\(n\)</span>에 대해서 표준정규분포를 따르게 됩니다.</p>
<p><span class="math display">\[
Z=\frac{\hat{p}-p}{SE(\hat{p})} = \frac{observed - expected}{SE} 
\]</span></p>
<p>따라서 모수 <span class="math inline">\(p\)</span>의 95% 신뢰구간에 대해서 다음과 같은 식을 얻을 수 있습니다.</p>
<p><span class="math display">\[
\hat{p}-1.96 \cdot SE(\hat{p}) &lt; p &lt; \hat{p}+1.96 \cdot SE(\hat{p}) 
\]</span></p>
<p>위 식의 1.96 값을 임계값 (critical value) 이라고 하며 <span class="math inline">\(1.96 \cdot SE(\hat{p})\)</span> 값을 오차한계 (margin of error)라고 합니다. 임계값은 신뢰구간에 따라서 달라지는 값으로 신뢰구간이 95%라면 <span class="math inline">\(\alpha = 0.05 (1-0.95)\)</span> 이고 임계값은 표준정규분포에서의 <code>qnorm</code> 함수를 이용해서 구할 수 있습니다.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="confidence-intervals.html#cb193-1"></a>conf &lt;-<span class="st"> </span><span class="dv">95</span></span>
<span id="cb193-2"><a href="confidence-intervals.html#cb193-2"></a>myalpha &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>conf<span class="op">/</span><span class="dv">100</span>)</span>
<span id="cb193-3"><a href="confidence-intervals.html#cb193-3"></a>critical_value &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>myalpha, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb193-4"><a href="confidence-intervals.html#cb193-4"></a></span>
<span id="cb193-5"><a href="confidence-intervals.html#cb193-5"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb193-6"><a href="confidence-intervals.html#cb193-6"></a>y &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb193-7"><a href="confidence-intervals.html#cb193-7"></a></span>
<span id="cb193-8"><a href="confidence-intervals.html#cb193-8"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)</span>
<span id="cb193-9"><a href="confidence-intervals.html#cb193-9"></a></span>
<span id="cb193-10"><a href="confidence-intervals.html#cb193-10"></a><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span></span>
<span id="cb193-11"><a href="confidence-intervals.html#cb193-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb193-12"><a href="confidence-intervals.html#cb193-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Density&quot;</span>) <span class="op">+</span></span>
<span id="cb193-13"><a href="confidence-intervals.html#cb193-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb193-14"><a href="confidence-intervals.html#cb193-14"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data=</span><span class="kw">filter</span>(dat, x <span class="op">&gt;</span><span class="st"> </span>critical_value), <span class="dt">fill=</span><span class="st">&quot;#ff000055&quot;</span>) <span class="op">+</span></span>
<span id="cb193-15"><a href="confidence-intervals.html#cb193-15"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data=</span><span class="kw">filter</span>(dat, x <span class="op">&lt;</span><span class="st"> </span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>critical_value)), <span class="dt">fill=</span><span class="st">&quot;#ff000055&quot;</span>) <span class="op">+</span></span>
<span id="cb193-16"><a href="confidence-intervals.html#cb193-16"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>critical_value, </span>
<span id="cb193-17"><a href="confidence-intervals.html#cb193-17"></a>                   <span class="dt">xend=</span>critical_value, </span>
<span id="cb193-18"><a href="confidence-intervals.html#cb193-18"></a>                   <span class="dt">y=</span><span class="fl">0.32</span>, </span>
<span id="cb193-19"><a href="confidence-intervals.html#cb193-19"></a>                   <span class="dt">yend=</span><span class="dv">0</span>), </span>
<span id="cb193-20"><a href="confidence-intervals.html#cb193-20"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;inches&quot;</span>)), </span>
<span id="cb193-21"><a href="confidence-intervals.html#cb193-21"></a>               <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb193-22"><a href="confidence-intervals.html#cb193-22"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, </span>
<span id="cb193-23"><a href="confidence-intervals.html#cb193-23"></a>           <span class="dt">label=</span><span class="kw">paste</span>(<span class="st">&quot;Critical value</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="kw">round</span>(critical_value,<span class="dv">3</span>)), </span>
<span id="cb193-24"><a href="confidence-intervals.html#cb193-24"></a>           <span class="dt">x=</span>critical_value, </span>
<span id="cb193-25"><a href="confidence-intervals.html#cb193-25"></a>           <span class="dt">y=</span><span class="fl">0.35</span>) <span class="op">+</span></span>
<span id="cb193-26"><a href="confidence-intervals.html#cb193-26"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="fl">3.5</span>, </span>
<span id="cb193-27"><a href="confidence-intervals.html#cb193-27"></a>                   <span class="dt">xend=</span><span class="dv">2</span>, </span>
<span id="cb193-28"><a href="confidence-intervals.html#cb193-28"></a>                   <span class="dt">y=</span><span class="fl">0.2</span>, </span>
<span id="cb193-29"><a href="confidence-intervals.html#cb193-29"></a>                   <span class="dt">yend=</span><span class="fl">0.02</span>), </span>
<span id="cb193-30"><a href="confidence-intervals.html#cb193-30"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;inches&quot;</span>)), </span>
<span id="cb193-31"><a href="confidence-intervals.html#cb193-31"></a>               <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb193-32"><a href="confidence-intervals.html#cb193-32"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, </span>
<span id="cb193-33"><a href="confidence-intervals.html#cb193-33"></a>           <span class="dt">label=</span><span class="kw">paste</span>(<span class="st">&quot;Alpha/2 &quot;</span>, myalpha<span class="op">/</span><span class="dv">2</span>), </span>
<span id="cb193-34"><a href="confidence-intervals.html#cb193-34"></a>           <span class="dt">x=</span><span class="fl">3.5</span>, </span>
<span id="cb193-35"><a href="confidence-intervals.html#cb193-35"></a>           <span class="dt">y=</span><span class="fl">0.21</span>)</span></code></pre></div>
<p><strong>[EXERCISE]</strong> 특정 찬성/반대 설문조사 인원이 1012명이고 그 중 찬성 비율이 0.46으로 나왔을 경우 95% 신뢰구간은 다음과 같이 구할 수 있습니다.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="confidence-intervals.html#cb194-1"></a>phat &lt;-<span class="st"> </span><span class="fl">0.46</span></span>
<span id="cb194-2"><a href="confidence-intervals.html#cb194-2"></a>n &lt;-<span class="st"> </span><span class="dv">1012</span></span>
<span id="cb194-3"><a href="confidence-intervals.html#cb194-3"></a>SE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)<span class="op">/</span>n)</span>
<span id="cb194-4"><a href="confidence-intervals.html#cb194-4"></a>lower &lt;-<span class="st"> </span>phat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.025</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>SE</span>
<span id="cb194-5"><a href="confidence-intervals.html#cb194-5"></a>upper &lt;-<span class="st"> </span>phat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>SE</span>
<span id="cb194-6"><a href="confidence-intervals.html#cb194-6"></a><span class="kw">c</span>(lower, upper)</span></code></pre></div>
<p><strong>[EXERCISE]</strong> 위 예제에 대한 90% 신뢰구간을 구하시오</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="confidence-intervals.html#cb195-1"></a>phat &lt;-<span class="st"> </span><span class="fl">0.46</span></span>
<span id="cb195-2"><a href="confidence-intervals.html#cb195-2"></a>n &lt;-<span class="st"> </span><span class="dv">1012</span></span>
<span id="cb195-3"><a href="confidence-intervals.html#cb195-3"></a>SE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)<span class="op">/</span>n)</span>
<span id="cb195-4"><a href="confidence-intervals.html#cb195-4"></a>lower &lt;-<span class="st"> </span>phat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.05</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>SE</span>
<span id="cb195-5"><a href="confidence-intervals.html#cb195-5"></a>upper &lt;-<span class="st"> </span>phat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>SE</span>
<span id="cb195-6"><a href="confidence-intervals.html#cb195-6"></a><span class="kw">c</span>(lower, upper)</span></code></pre></div>
<p><strong>[EXERCISE]</strong> <code>prop.test</code> 함수를 사용해서 95%, 90% 신뢰구간을 구하시오</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="confidence-intervals.html#cb196-1"></a>?prop.test</span>
<span id="cb196-2"><a href="confidence-intervals.html#cb196-2"></a>phat &lt;-<span class="st"> </span><span class="fl">0.46</span></span>
<span id="cb196-3"><a href="confidence-intervals.html#cb196-3"></a>n &lt;-<span class="st"> </span><span class="dv">1012</span></span>
<span id="cb196-4"><a href="confidence-intervals.html#cb196-4"></a>fit &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="dt">x=</span>n<span class="op">*</span>phat, <span class="dt">n=</span>n, <span class="dt">conf.level=</span><span class="fl">0.95</span>)</span>
<span id="cb196-5"><a href="confidence-intervals.html#cb196-5"></a>fit<span class="op">$</span>conf.int</span>
<span id="cb196-6"><a href="confidence-intervals.html#cb196-6"></a>fit &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="dt">x=</span>n<span class="op">*</span>phat, <span class="dt">n=</span>n, <span class="dt">conf.level=</span><span class="fl">0.9</span>)</span>
<span id="cb196-7"><a href="confidence-intervals.html#cb196-7"></a>fit<span class="op">$</span>conf.int</span></code></pre></div>
</div>
<div id="ci-for-population-mean" class="section level2">
<h2><span class="header-section-number">9.2</span> CI for population mean</h2>
<p>정규분포 모평균의 신뢰구간을 구할 때도 위 모비율과 유사한 방법을 사용합니다. 중심극한정리에서 표본평균의 <span class="math inline">\(\bar{X}\)</span>의 분포는 <span class="math inline">\(\bar{X} \sim N(\mu, \frac{\sigma}{\sqrt{n}})\)</span> 입니다. 따라서 정규분포를 따르는 표본평균 <span class="math inline">\(\bar{x}\)</span>의 표준화된 통계량 <span class="math inline">\(Z\)</span>은 다음과 같습니다.</p>
<p><span class="math display">\[
Z = \frac{\bar{x}-\mu}{\sigma / \sqrt{n}} = \frac{\bar{x}-\mu}{SD(\bar{x})} 
\]</span></p>
<p>그러나 앞서 언급한바와 같이 모표준편차 <span class="math inline">\(\sigma\)</span>는 알 수 없으며 따라서 표본표준편차인 <span class="math inline">\(s\)</span>를 대신 사용한 표준오차를 사용하게 됩니다. 이 때 <span class="math inline">\(Z\)</span> 값은 표준정규분포가 아닌 T분포를 따르게 되며 이는 다음과 같은 통계량을 가집니다.</p>
<p><span class="math display">\[
T = \frac{\bar{x}-\mu}{s / \sqrt{n}} = \frac{\bar{x}-\mu}{SE(\bar{x})} = \frac{observed - expected}{SE}
\]</span></p>
<p>유의수준 (significance level)을 <span class="math inline">\(\alpha\)</span>라 하면 신뢰구간은 다음과 같이 표현이 가능합니다. 이는 데이터가 모여있는 구간이라는 신뢰구간의 해석과 상통합니다.</p>
<p><span class="math display">\[
\begin{split}
P(-t^* &lt; \frac{\bar{x}-\mu}{s / \sqrt{n}} &lt; t^*) = 1 - \alpha \\
P(\bar{x}-t^* \cdot SE &lt; \mu &lt; \bar{x} + t^* \cdot SE ) = 1 - \alpha 
\end{split}
\]</span></p>
<p>여기서 임계값 <span class="math inline">\(t^*\)</span>는 t분포의 <code>q</code> 함수인 <code>qt()</code>를 사용해서 구할 수 있습니다.</p>
<p><strong>[EXERCISE]</strong> 한 반에 30명 학생들의 평균 키가 66인치이고 표준편차는 4인치인 경우 전체 학교 학생의 평균 키에 대한 80% 신뢰구간을 구하면 다음과 같습니다.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="confidence-intervals.html#cb197-1"></a>xbar &lt;-<span class="st"> </span><span class="dv">66</span> </span>
<span id="cb197-2"><a href="confidence-intervals.html#cb197-2"></a>s &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb197-3"><a href="confidence-intervals.html#cb197-3"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb197-4"><a href="confidence-intervals.html#cb197-4"></a>alpha &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.8</span></span>
<span id="cb197-5"><a href="confidence-intervals.html#cb197-5"></a>tstar &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb197-6"><a href="confidence-intervals.html#cb197-6"></a>SE &lt;-<span class="st"> </span>s<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb197-7"><a href="confidence-intervals.html#cb197-7"></a>MOE &lt;-<span class="st"> </span>tstar <span class="op">*</span><span class="st"> </span>SE</span>
<span id="cb197-8"><a href="confidence-intervals.html#cb197-8"></a>xbar <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>MOE</span></code></pre></div>
<p><strong>[EXERCISE]</strong> 어떤 커피전문점의 바리스타가 25초 기계를 돌리면 에스프레소 2온스가 나온다고 훈련을 받았다. 8번 시험을 해 본 결과 다음과 같은 무게의 에스프레소가 나왔다. 1.95, 1.8, 2.10, 1.82, 1.75, 2.01, 1.83, 1.9. 평균 샷 사이즈의 90% 신뢰구간을 구하고 이 구간에 2.0 온스가 들어가는지 검사하시오</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="confidence-intervals.html#cb198-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.95</span>, <span class="fl">1.8</span>, <span class="fl">2.10</span>, <span class="fl">1.82</span>, <span class="fl">1.75</span>, <span class="fl">2.01</span>, <span class="fl">1.83</span>, <span class="fl">1.9</span>)</span>
<span id="cb198-2"><a href="confidence-intervals.html#cb198-2"></a><span class="kw">t.test</span>(x, <span class="dt">conf.level =</span> <span class="fl">0.9</span>)</span></code></pre></div>
</div>
<div id="ci-for-the-differences" class="section level2">
<h2><span class="header-section-number">9.3</span> CI for the differences</h2>
<p>앞서까지는 univariate의 경우에서 모수 추정의 신뢰구간을 구하는 과정을 보여주었습니다. 이제 bivariate의 경우, 즉 두 개의 표본이 있을 경우 두 표본이 같은 분포를 가지고 있는지를 (같은 집단에서 추출된 것인지) 비교하는 경우입니다.</p>
<p>두 표본의 비율을 비교하기 위해서 다음과 같은 차이를 계산할 수 있습니다.</p>
<p><span class="math display">\[
\begin{split}
Z &amp;= \frac{(\hat{p_1}-\hat{p_2}) - (p_1-p_2)}{SE(\hat{p_1}-\hat{p_2})}\\ 
\\
 &amp;= \frac{\text{observed} - \text{expected}}{\text{SE}}
 \end{split}
 \]</span></p>
<p>위 통계량은 <span class="math inline">\(n_1\)</span>, <span class="math inline">\(n_2\)</span>가 충분히 클경우 표준정규분포를 따르며 표준오차 SE는 다음과 같습니다.</p>
<p><span class="math display">\[
SE(\hat{p_1}-\hat{p_2}) = \sqrt{\frac{\hat{p_1}(1-\hat{p_1})}{n_1} + \frac{\hat{p_2}(1-\hat{p_2})}{n_2}}
\]</span></p>
<p><strong>[EXERCISE]</strong> 2주에 걸처 두 번의 투표를 실시하였다. 첫 번째는 1000명에게서 560명의 동의가 있었고 두 번째는 1200명에게서 570명의 동의가 있었다. 두 투표 결과 비율의 차이에 대한 95% 신뢰구간을 구하고 의미를 해석하시오. 즉,</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="confidence-intervals.html#cb199-1"></a><span class="kw">prop.test</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">560</span>, <span class="dv">570</span>), <span class="dt">n=</span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">1200</span>), <span class="dt">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<p>많은 경우 두 표본이 같은 모집단으로부터 추출되었는지 비교하는 경우가 많으며 이 경우는 평균의 차이가 0인지를 비교하는 경우와 같습니다. <span class="math inline">\(x_1, x_2, ..., x_{n_x}\)</span>와 <span class="math inline">\(y_1, y_2, ..., y_{n_y}\)</span> 두 표본이 있을 때 <span class="math inline">\(\bar{x}\)</span>와 <span class="math inline">\(\bar{y}\)</span>를 각각 두 표본의 평균, <span class="math inline">\(s^2_x\)</span>와 <span class="math inline">\(x^2_y\)</span>를 각각 두 표본의 분산이라 하겠습니다. 각 표본이 정규분포를 따를 경우 <span class="math inline">\(\bar{x} - \bar{y}\)</span>의 분포는 정규분포이고 다음 통계량은 <span class="math inline">\(n_x\)</span>와 <span class="math inline">\(n_y\)</span>가 충분히 클 경우 T 분포를 따릅니다.</p>
<p><span class="math display">\[
\begin{split}
T = \frac{(\bar{x}-\bar{y}) - (\mu_x-\mu_y)}{SE(\bar{x}-\bar{y})} 
\end{split}
 \]</span></p>
<p>여기서 SE는 두 표본의 분산이 같은 것으로 가정할지 아니면 다른 것으로 가정할지에 따라서 다르게 계산 됩니다. 일반적으로 같은 분포를 가정하고 계산을 하며 이 때 SE는 다음과 같습니다.</p>
<p><span class="math display">\[
\begin{split}
SE(\bar{x}-\bar{y}) = \sqrt{s^2_p (1/n_x + 1/n_y)} \\
\\
\text{where } s^2_p = \frac{(n_x-1)s^2_x + (n_y-1)s^2_y}{n_x + n_y -2}
\end{split}
 \]</span>
이 경우 자유도는 <span class="math inline">\(n_x + n_y -2\)</span> 입니다. (자유도 개념은 녹음 파일로 설명 드리겠습니다) 따라서 두 표본의 평균들의 차이에 대한 (1-<span class="math inline">\(\alpha\)</span>) <span class="math inline">\(\cdot\)</span> 100% 신뢰구간은 다음과 같습니다.</p>
<p><span class="math display">\[
(\bar{x} - \bar{y}) \pm t^*\cdot SE(\bar{x}-\bar{y}) 
\]</span></p>
<p><span class="math inline">\(t^*\)</span>는 t분포에서 유의수준과 자유도에 따라 구할수 있습니다. 예를들어 신뢰수준 90%에 대해서 자유도 20을 갖는 t값은 분포의 양 끝쪽 면적(확률이) 0.1 이고 왼쪽만 고려하면 0.05 이므로 그 때 <span class="math inline">\(t^*\)</span> 값은 <code>qt(0.05, df=20) = -1.7247</code> 입니다. 또한 <code>t.test()</code>라는 함수를 사용해서 다음 예제와 같이 구할 수도 있습니다.</p>
<p><strong>[EXERCISE]</strong> 어떤 다이어트약이 효과가 있는지를 플라시보 약과 함께 다음 13명의 사람들에게 실험 후 감소된 몸무게를 측정하였다. 90% 신뢰구간을 구하시오 (등분산 가정).</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="confidence-intervals.html#cb200-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">17</span>)</span>
<span id="cb200-2"><a href="confidence-intervals.html#cb200-2"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>)</span>
<span id="cb200-3"><a href="confidence-intervals.html#cb200-3"></a><span class="kw">t.test</span>(x, y, <span class="dt">var.equal=</span>T, <span class="dt">conf.level=</span><span class="fl">0.90</span>)</span></code></pre></div>
<p>짝데이터에 대한 신뢰구간을 구하는 방법을 살펴 보겠습니다. 이 경우 표본이 서로 독립이 아니게 됩니다. T 통계량은 앞서 평균의 차이를 구하는 경우의 통계량과 같습니다. 즉, <span class="math inline">\(x_1, x_2, ..., x_{n_x}\)</span>와 <span class="math inline">\(y_1, y_2, ..., y_{n_y}\)</span> 두 표본이 있을 때 <span class="math inline">\(\bar{x}\)</span>와 <span class="math inline">\(\bar{y}\)</span>를 각각 두 표본의 평균, <span class="math inline">\(s^2_x\)</span>와 <span class="math inline">\(x^2_y\)</span>를 각각 두 표본의 분산이라 하면 T 통계량은 다음과 같습니다.</p>
<p><span class="math display">\[
\begin{split}
T = \frac{(\bar{x}-\bar{y}) - (\mu_x-\mu_y)}{SE(\bar{x}-\bar{y})} 
\end{split}
 \]</span>
그러나 표준오차는 앞서와 같지 않습니다. 짝데이터의 경우는 두 값을 뺀 차이를 하나의 표본으로 간주할 수 있으므로 (<span class="math inline">\(z_i=x_i-y_i\)</span>) 다음과 같이 하나의 표본일 때 표준오차를 계산하는 경우와 같습니다.</p>
<p><span class="math display">\[
(\bar{x} - \bar{y}) \pm t^*\cdot s/\sqrt{n} 
\]</span></p>
<p>여기서 <span class="math inline">\(s\)</span>는 각 샘플의 차이에 (<span class="math inline">\(x_i - y_i\)</span>) 대한 표준편차 값이며 자유도는 <span class="math inline">\(n-1\)</span>과 같습니다. 신뢰구간 또한 <code>t.test(x, y, paired=T)</code>함수를 사용할 수 있습니다.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="confidence-intervals.html#cb201-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb201-2"><a href="confidence-intervals.html#cb201-2"></a><span class="kw">names</span>(shoes)</span>
<span id="cb201-3"><a href="confidence-intervals.html#cb201-3"></a></span>
<span id="cb201-4"><a href="confidence-intervals.html#cb201-4"></a><span class="kw">t.test</span>(shoes<span class="op">$</span>A <span class="op">-</span><span class="st"> </span>shoes<span class="op">$</span>B, <span class="dt">conf.level=</span><span class="fl">0.9</span>)</span></code></pre></div>
</div>
<div id="problem-09" class="section level2">
<h2><span class="header-section-number">9.4</span> Problem 09</h2>
<ol style="list-style-type: decimal">
<li>다음은 두 학생 그룹의 IQ를 검사한 결과이다. 두 그룹간 아이큐 차이에 대한 90% 신뢰구간을 구하시오 (등분산 가정, <code>t.test</code> 사용)</li>
</ol>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="confidence-intervals.html#cb202-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">88</span>, <span class="dv">75</span>, <span class="dv">113</span>, <span class="dv">95</span>, <span class="dv">82</span>, <span class="dv">97</span>, <span class="dv">94</span>, <span class="dv">132</span>, <span class="dv">108</span>)</span>
<span id="cb202-2"><a href="confidence-intervals.html#cb202-2"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">79</span>, <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">82</span>, <span class="dv">87</span>, <span class="dv">94</span>, <span class="dv">131</span>, <span class="dv">115</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>위 1)에서 <code>t.test</code> 함수를 사용하지 않고 <code>qt</code>를 사용하고 표준오차 값을 직접 계산해서 90% 신뢰구간을 구하시오</p></li>
<li><p>만약 위 1) 데이터가 쌍둥이 10쌍에 대한 데이터일 경우 90% 신뢰구간을 구하고 앞서 1)의 신뢰구간과 차이를 비교하고 해석하시오.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="significance-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
